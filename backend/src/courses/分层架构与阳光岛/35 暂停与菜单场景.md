# æš‚åœä¸èœå•åœºæ™¯

<div class="video-container">
  <div id="bilibili" class="video-content">
    <!-- Bç«™åµŒå…¥ï¼šä½¿ç”¨ https æ˜ç¡®åè®®ï¼ˆé¿å… file:// æˆ– http å¯¼è‡´è¢«æµè§ˆå™¨æ‹¦æˆªï¼‰ -->
    <iframe
      class="video-frame"
      src="https://player.bilibili.com/player.html?bvid=BV1MiexzWEcT&page=1&autoplay=0&danmaku=0&high_quality=1"
      width="100%"
      height="480"
      scrolling="no"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>
</div>

[åœ¨ Bilibili ä¸Šè§‚çœ‹](https://www.bilibili.com/video/BV1MiexzWEcT)

## ğŸ“Œ é—®é¢˜èƒŒæ™¯

æ¬¢è¿æ¥åˆ°ã€ŠC++æ¸¸æˆå¼€å‘ä¹‹æ—…ã€‹çš„ç¬¬35è¯¾ï¼åœ¨ä»»ä½•æ¸¸æˆä¸­ï¼Œ**æš‚åœåŠŸèƒ½éƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„**ã€‚å®ƒè®©ç©å®¶å¯ä»¥åœ¨éœ€è¦æ—¶ä¸­æ–­æ¸¸æˆï¼Œå¤„ç†ç°å®ä¸–ç•Œçš„äº‹æƒ…ï¼Œæˆ–è€…åœ¨ç´§å¼ çš„æˆ˜æ–—ä¸­å–˜å£æ°”ã€æ€è€ƒç­–ç•¥ã€‚åœ¨ä¸Šä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬æŒæ¡äº†åœºæ™¯çš„ Push å’Œ Pop æ“ä½œï¼Œè¿™ä¸ºå®ç°ä¸€ä¸ªå®Œç¾çš„æš‚åœèœå•å¥ å®šäº†åŸºç¡€ã€‚

### âš ï¸ å½“å‰çš„é—®é¢˜

```
æ— æš‚åœåŠŸèƒ½çš„æ¸¸æˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GameScene è¿è¡Œä¸­        â”‚
â”‚ ğŸ‘¤ ç©å®¶ç§»åŠ¨             â”‚
â”‚ ğŸ‘¾ æ•Œäººæ”»å‡»             â”‚
â”‚ âš™ï¸ ç‰©ç†æ›´æ–°             â”‚
â”‚                         â”‚
â”‚ ç”¨æˆ·æŒ‰ESC...            â”‚
â”‚ âŒ æ— æ³•æš‚åœ             â”‚
â”‚ âŒ æ¸¸æˆç»§ç»­è¿è¡Œ         â”‚
â”‚ âŒ æ— æ³•ä¼‘æ¯             â”‚
â”‚ âŒ ä½“éªŒä¸å‹å¥½           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é—®é¢˜ | è¯´æ˜ | å½±å“ |
|------|------|------|
| **æ— æš‚åœåŠŸèƒ½** | æ— æ³•ä¸­æ–­æ¸¸æˆ | ç”¨æˆ·ä½“éªŒå·® |
| **å‡æš‚åœ** | åªå åŠ UIï¼Œæ¸¸æˆä»è¿è¡Œ | ä¸æ˜¯çœŸæš‚åœ |
| **æ— çŠ¶æ€ç®¡ç†** | æ— æ³•åŒºåˆ†æ¸¸æˆçŠ¶æ€ | é€»è¾‘æ··ä¹± |
| **æ§åˆ¶ç²—ç³™** | æ— æ³•ç²¾ç»†æ§åˆ¶æ›´æ–° | åŠŸèƒ½å—é™ |

### ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šå…¨å±€æ¸¸æˆçŠ¶æ€

ç„¶è€Œï¼Œä¸€ä¸ªå¥½çš„æš‚åœç³»ç»Ÿä¸ä»…ä»…æ˜¯åœ¨æ¸¸æˆåœºæ™¯ä¹‹ä¸Š"è¦†ç›–"ä¸€ä¸ªèœå•ã€‚**å½“æˆ‘ä»¬æš‚åœæ—¶ï¼ŒèƒŒæ™¯ä¸­çš„æ¸¸æˆä¸–ç•Œï¼ˆç©å®¶ã€æ•Œäººã€ç‰©ç†æ•ˆæœï¼‰å¿…é¡»çœŸæ­£åœ°åœæ­¢**ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„æ ¸å¿ƒæ¦‚å¿µï¼š**å…¨å±€æ¸¸æˆçŠ¶æ€ï¼ˆGlobal Game Stateï¼‰**ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
1. å¼•å…¥GameStateç®¡ç†æ¸¸æˆçŠ¶æ€
2. é›†æˆåˆ°Contextå…¨å±€è®¿é—®
3. æ¡ä»¶å¼æ›´æ–°ç‰©ç†å’Œç›¸æœº
4. åˆ›å»ºMenuSceneå®ç°æš‚åœ

```
æš‚åœç³»ç»Ÿæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Context             â”‚ â† å…¨å±€ä¸Šä¸‹æ–‡
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GameState          â”‚  â”‚ â† çŠ¶æ€ç®¡ç†å™¨ âœ¨
â”‚  â”‚ â€¢ Title            â”‚  â”‚
â”‚  â”‚ â€¢ Playing          â”‚  â”‚
â”‚  â”‚ â€¢ Paused           â”‚  â”‚
â”‚  â”‚ â€¢ GameOver         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æŸ¥è¯¢çŠ¶æ€
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Scene::update()     â”‚ â† æ¡ä»¶æ›´æ–°
â”‚  if (isPlaying()) {      â”‚
â”‚    ç‰©ç†æ›´æ–° âœ…           â”‚
â”‚    ç›¸æœºæ›´æ–° âœ…           â”‚
â”‚  } else {                â”‚
â”‚    è·³è¿‡æ›´æ–° â¸ï¸           â”‚
â”‚  }                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

çœŸæ­£çš„æš‚åœæ§åˆ¶ï¼
```

### ğŸ¯ æœ¬è¯¾ç›®æ ‡

| ç›®æ ‡ | è¯´æ˜ |
|------|------|
| **å¼•å…¥GameState** | ç®¡ç†æ¸¸æˆçš„å®è§‚çŠ¶æ€ |
| **é›†æˆåˆ°Context** | å…¨å±€è®¿é—®çŠ¶æ€ä¿¡æ¯ |
| **æ¡ä»¶å¼æ›´æ–°** | æ ¹æ®çŠ¶æ€æ§åˆ¶æ›´æ–° |
| **åˆ›å»ºMenuScene** | å®ç°æš‚åœèœå•åŠŸèƒ½ |

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šGameState è®¾è®¡

### ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µï¼šå…¨å±€æ¸¸æˆçŠ¶æ€

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æ¸¸æˆæ€»æ˜¯åœ¨"è¿è¡Œ"ã€‚ä½†ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ›´ç²¾ç»†çš„åˆ’åˆ†ã€‚æ¸¸æˆå¯èƒ½å¤„äº"æ ‡é¢˜ç•Œé¢"ã€"æ­£å¸¸æ¸¸ç©"æˆ–"æš‚åœ"ç­‰ä¸åŒçŠ¶æ€ã€‚**GameState ç±»å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿ**ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸­å¿ƒåŒ–çš„ç®¡ç†å™¨ï¼Œè´Ÿè´£è·Ÿè¸ªå’Œåˆ‡æ¢è¿™äº›å®è§‚çŠ¶æ€ã€‚

```
æ¸¸æˆçŠ¶æ€æµè½¬ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Title   â”‚ â† æ ‡é¢˜ç•Œé¢
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚ å¼€å§‹æ¸¸æˆ
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Playing  â”‚ â† æ¸¸æˆè¿›è¡Œä¸­
â””â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜
   â”‚   â”‚ æŒ‰æš‚åœé”®
   â”‚   â†“
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â”‚ Paused   â”‚ â† æ¸¸æˆæš‚åœ
   â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
   â”‚      â”‚ ç»§ç»­
   â”‚      â†“
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ â”‚ Playing  â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”‚ æ¸¸æˆç»“æŸ
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚GameOver  â”‚ â† ç»“æŸç•Œé¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. GameState ç±»è®¾è®¡

<img src="https://theorhythm.top/gamedev/SL/SL.101.webp" alt="æ¸¸æˆçŠ¶æ€ç±»" style="display: block; margin: auto; width: 700px;" />

æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªæšä¸¾ `State` æ¥è¡¨ç¤ºè¿™äº›çŠ¶æ€ã€‚

### src/engine/core/game_state.hï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰

```cpp
#pragma once
#include <glm/vec2.hpp>
#include <SDL3/SDL_video.h>
#include <SDL3/SDL_render.h>

namespace engine::core {

/**
 * @enum State
 * @brief å®šä¹‰æ¸¸æˆå¯èƒ½å¤„äºçš„å®è§‚çŠ¶æ€ã€‚
 */
enum class State {
    Title,          // æ ‡é¢˜ç•Œé¢
    Playing,        // æ­£å¸¸æ¸¸æˆè¿›è¡Œä¸­
    Paused,         // æ¸¸æˆæš‚åœ
    GameOver,       // æ¸¸æˆç»“æŸç•Œé¢
};

/**
 * @brief ç®¡ç†å’ŒæŸ¥è¯¢æ¸¸æˆçš„å…¨å±€å®è§‚çŠ¶æ€ã€‚
 */
class GameState final {
private:    
    SDL_Window* window_ = nullptr;
    SDL_Renderer* renderer_ = nullptr;
    State current_state_ = State::Title;

public:
    explicit GameState(SDL_Window* window, SDL_Renderer* renderer, State initial_state = State::Title);

    State getCurrentState() const { return current_state_; }
    void setState(State new_state);
    
    // ... å…¶ä»–è¾…åŠ©å‡½æ•°ï¼Œå¦‚è·å–çª—å£/é€»è¾‘åˆ†è¾¨ç‡ ...

    // --- ä¾¿æ·æŸ¥è¯¢æ–¹æ³• ---
    bool isPlaying() const { return current_state_ == State::Playing; }
    bool isPaused() const { return current_state_ == State::Paused; }
};

} // namespace engine::core
```

### ğŸ’¡ è®¾è®¡è¯´æ˜

```
GameState æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      GameState           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ current_state_     â”‚  â”‚ â† å½“å‰çŠ¶æ€
â”‚  â”‚ â€¢ Title            â”‚  â”‚
â”‚  â”‚ â€¢ Playing          â”‚  â”‚
â”‚  â”‚ â€¢ Paused           â”‚  â”‚
â”‚  â”‚ â€¢ GameOver         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ setState()         â”‚  â”‚ â† åˆ‡æ¢çŠ¶æ€
â”‚  â”‚ getCurrentState()  â”‚  â”‚   è·å–çŠ¶æ€
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä¾¿æ·æ–¹æ³•           â”‚  â”‚ â† å¿«æ·æŸ¥è¯¢
â”‚  â”‚ â€¢ isPlaying()      â”‚  â”‚
â”‚  â”‚ â€¢ isPaused()       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çŠ¶æ€è¯´æ˜

| çŠ¶æ€ | è¯´æ˜ | å…¸å‹åœºæ™¯ | æ›´æ–°è¡Œä¸º |
|-----|------|---------|---------|
| **Title** | æ ‡é¢˜ç•Œé¢ | TitleScene | UIæ›´æ–°ï¼ŒèƒŒæ™¯æ»šåŠ¨ |
| **Playing** | æ¸¸æˆè¿›è¡Œä¸­ | GameScene | å®Œæ•´æ›´æ–° |
| **Paused** | æ¸¸æˆæš‚åœ | MenuSceneå åŠ  | åªæ›´æ–°UI |
| **GameOver** | æ¸¸æˆç»“æŸ | GameOverScene | åªæ›´æ–°UI |

è¿™ä¸ªç±»ä¸ä»…å­˜å‚¨å½“å‰çŠ¶æ€ï¼Œè¿˜æä¾›äº†ä¸€äº›ä¾¿æ·çš„æŸ¥è¯¢æ–¹æ³•ï¼Œå¦‚ `isPlaying()`ã€‚

### ä¾¿æ·æ–¹æ³•çš„ä»·å€¼

```
ä¾¿æ·æ–¹æ³•å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¼ ç»Ÿæ–¹å¼ï¼š           â”‚
â”‚ if (state.getCurrent()â”‚
â”‚     == State::Playing)â”‚
â”‚   ...                â”‚
â”‚ â†’ å•°å—¦               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¾¿æ·æ–¹æ³•ï¼š           â”‚
â”‚ if (state.isPlaying())â”‚
â”‚   ...                â”‚
â”‚ â†’ ç®€æ´æ¸…æ™° âœ…        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šGameState é›†æˆ

### ğŸ’¡ å°† GameState é›†æˆåˆ°å¼•æ“

ä¸ºäº†è®©å¼•æ“çš„å„ä¸ªéƒ¨åˆ†ï¼ˆå°¤å…¶æ˜¯åœºæ™¯ï¼‰éƒ½èƒ½æ„ŸçŸ¥åˆ°å½“å‰çš„æ¸¸æˆçŠ¶æ€ï¼Œæˆ‘ä»¬å¿…é¡»å°† GameState å®ä¾‹æ•´åˆåˆ° **Context** ä¸­ã€‚

---

## 2. é›†æˆåˆ° Context

### src/engine/core/game_app.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// GameApp::init() ä¸­å¢åŠ  GameState çš„åˆå§‹åŒ–
bool GameApp::initGameState()
{
    try {
        game_state_ = std::make_unique<engine::core::GameState>(window_, sdl_renderer_);
    } catch (const std::exception& e) {
        spdlog::error("åˆå§‹åŒ–æ¸¸æˆçŠ¶æ€å¤±è´¥: {}", e.what());
        return false;
    }
    return true;
}

// GameApp::initContext() ä¸­å°† game_state_ ä¼ å…¥ Context
bool GameApp::initContext()
{
    try {
        context_ = std::make_unique<engine::core::Context>(*input_manager_, 
                                                           *renderer_, 
                                                           *camera_,
                                                           *text_renderer_,
                                                           *resource_manager_, 
                                                           *physics_engine_, 
                                                           *audio_player_,
                                                           *game_state_); // æ–°å¢
    } 
    // ...
}
```

### é›†æˆæµç¨‹

```
GameState é›†æˆæµç¨‹ï¼š
    â†“
1. GameApp::initGameState()
   åˆ›å»º GameState å®ä¾‹
    â†“
2. GameApp::initContext()
   å°† game_state_ ä¼ å…¥ Context
    â†“
3. å…¨å±€å¯è®¿é—®
   context_.getGameState()
    â†“
å®Œæˆï¼æ‰€æœ‰æ¨¡å—å¯æŸ¥è¯¢çŠ¶æ€
```

ç°åœ¨ï¼Œä»»ä½•èƒ½è®¿é—® `context_` çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡ `context_.getGameState()` æ¥æŸ¥è¯¢æˆ–æ”¹å˜æ¸¸æˆçŠ¶æ€ã€‚

### Context æ ¸å¿ƒæœåŠ¡æ›´æ–°

```
Context æä¾›çš„æœåŠ¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Context              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ InputManager       â”‚ â† è¾“å…¥ç®¡ç†
â”‚ â€¢ Renderer           â”‚ â† å›¾å½¢æ¸²æŸ“
â”‚ â€¢ Camera             â”‚ â† ç›¸æœºæ§åˆ¶
â”‚ â€¢ TextRenderer       â”‚ â† æ–‡å­—æ¸²æŸ“
â”‚ â€¢ ResourceManager    â”‚ â† èµ„æºç®¡ç†
â”‚ â€¢ PhysicsEngine      â”‚ â† ç‰©ç†å¼•æ“
â”‚ â€¢ AudioPlayer        â”‚ â† éŸ³é¢‘æ’­æ”¾
â”‚ â€¢ GameState          â”‚ â† çŠ¶æ€ç®¡ç† âœ¨æ–°å¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…¨å±€è®¿é—®æ¥å£ï¼
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ¡ä»¶å¼æ›´æ–°

### ğŸ’¡ å®ç°"çœŸæ­£çš„æš‚åœ"

è¿™æ˜¯å®ç°æš‚åœåŠŸèƒ½çš„å…³é”®ä¸€æ­¥ã€‚æˆ‘ä»¬ä¿®æ”¹ Scene åŸºç±»çš„ `update` æ–¹æ³•ï¼Œè®©ç‰©ç†å¼•æ“å’Œç›¸æœºçš„æ›´æ–°**åªåœ¨æ¸¸æˆçŠ¶æ€ä¸º Playing æ—¶æ‰§è¡Œ**ã€‚

---

## 3. æ¡ä»¶å¼æ›´æ–°å®ç°

### src/engine/scene/scene.cppï¼ˆæ›´æ–°ï¼‰

```cpp
void Scene::update(float delta_time) {
    if (!is_initialized_) return;
    
    // åªæœ‰æ¸¸æˆè¿›è¡Œä¸­ï¼Œæ‰éœ€è¦æ›´æ–°ç‰©ç†å¼•æ“å’Œç›¸æœº
    if (context_.getGameState().isPlaying()){
        context_.getPhysicsEngine().update(delta_time);
        context_.getCamera().update(delta_time);
    }

    // æ¸¸æˆå¯¹è±¡å’ŒUIçš„æ›´æ–°ä¸å—å½±å“ï¼Œå› ä¸ºæš‚åœæ—¶æˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦UIåŠ¨ç”»
    for (auto it = game_objects_.begin(); it != game_objects_.end();) {
        // ...
    }
    ui_manager_->update(delta_time);
}
```

### æ›´æ–°ç­–ç•¥

```
æ¡ä»¶å¼æ›´æ–°é€»è¾‘ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scene::update()          â”‚
â”‚    â†“                     â”‚
â”‚ if (isPlaying()) {       â”‚
â”‚    âœ… ç‰©ç†å¼•æ“æ›´æ–°       â”‚
â”‚    âœ… ç›¸æœºæ›´æ–°           â”‚
â”‚ } else {                 â”‚
â”‚    â¸ï¸ è·³è¿‡ç‰©ç†æ›´æ–°       â”‚
â”‚    â¸ï¸ è·³è¿‡ç›¸æœºæ›´æ–°       â”‚
â”‚ }                        â”‚
â”‚    â†“                     â”‚
â”‚ ğŸ”„ æ¸¸æˆå¯¹è±¡æ›´æ–°ï¼ˆæ€»æ˜¯ï¼‰  â”‚
â”‚ ğŸ”„ UIæ›´æ–°ï¼ˆæ€»æ˜¯ï¼‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç²¾ç»†æ§åˆ¶ï¼ŒçœŸæ­£æš‚åœï¼
```

### æ›´æ–°åˆ†ç±»

| æ›´æ–°ç±»å‹ | PlayingçŠ¶æ€ | PausedçŠ¶æ€ | åŸå›  |
|---------|------------|-----------|------|
| **ç‰©ç†å¼•æ“** | âœ… æ›´æ–° | â¸ï¸ æš‚åœ | é¿å…æ¸¸æˆç»§ç»­ |
| **ç›¸æœº** | âœ… æ›´æ–° | â¸ï¸ æš‚åœ | å›ºå®šè§†è§’ |
| **æ¸¸æˆå¯¹è±¡** | âœ… æ›´æ–° | âœ… æ›´æ–° | å¯èƒ½éœ€è¦åŠ¨ç”» |
| **UI** | âœ… æ›´æ–° | âœ… æ›´æ–° | èœå•éœ€è¦äº¤äº’ |

è¿™æ ·ä¸€æ¥ï¼Œåªè¦æˆ‘ä»¬å°†æ¸¸æˆçŠ¶æ€åˆ‡æ¢åˆ° `Paused`ï¼Œæ•´ä¸ªæ¸¸æˆä¸–ç•Œçš„åŠ¨æ€å°±å†»ç»“äº†ï¼Œè€Œ**UIç³»ç»Ÿä¾ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œ**ã€‚

### ä¸ºä»€ä¹ˆUIç»§ç»­æ›´æ–°ï¼Ÿ

```
UIç»§ç»­æ›´æ–°çš„åŸå› ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æš‚åœèœå•éœ€è¦ï¼š       â”‚
â”‚ â€¢ æŒ‰é’®æ‚¬åœæ•ˆæœ       â”‚
â”‚ â€¢ ç‚¹å‡»åé¦ˆ           â”‚
â”‚ â€¢ åŠ¨ç”»æ•ˆæœ           â”‚
â”‚ â€¢ ç”¨æˆ·äº¤äº’           â”‚
â”‚                      â”‚
â”‚ å¦‚æœUIä¹Ÿæš‚åœï¼š       â”‚
â”‚ âŒ æŒ‰é’®æ— ååº”        â”‚
â”‚ âŒ æ— æ³•ç‚¹å‡»          â”‚
â”‚ âŒ ä½“éªŒç³Ÿç³•          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

UIå¿…é¡»ä¿æŒæ´»è·ƒï¼
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šMenuScene å®ç°

### ğŸ’¡ åˆ›å»ºæš‚åœèœå•

MenuScene æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæš‚åœçŠ¶æ€çš„åœºæ™¯ã€‚å®ƒä¼šåœ¨ GameScene ä¹‹ä¸Šè¢« Push è¿›æ¥ã€‚

---

## 4. MenuScene è®¾è®¡

### src/game/scene/menu_scene.cppï¼ˆå®ç°ï¼‰

```cpp
void MenuScene::init() {
    // å…³é”®ï¼šè¿›å…¥èœå•åœºæ™¯æ—¶ï¼Œå°†æ¸¸æˆçŠ¶æ€è®¾ä¸ºæš‚åœ
    context_.getGameState().setState(engine::core::State::Paused);
    createUI(); // åˆ›å»º"ç»§ç»­"ã€"ä¿å­˜"ã€"è¿”å›"ç­‰æŒ‰é’®
    Scene::init();
}

void MenuScene::handleInput() {
    Scene::handleInput();

    // å…è®¸é€šè¿‡å†æ¬¡æŒ‰æš‚åœé”®æ¥æ¢å¤æ¸¸æˆ
    if (context_.getInputManager().isActionPressed("pause")) {
        scene_manager_.requestPopScene();       // å¼¹å‡ºè‡ªèº«
        context_.getGameState().setState(engine::core::State::Playing); // æ¢å¤æ¸¸æˆçŠ¶æ€
    }
}

// "ç»§ç»­æ¸¸æˆ"æŒ‰é’®çš„å›è°ƒ
void MenuScene::onResumeClicked() {
    scene_manager_.requestPopScene();           // å¼¹å‡ºè‡ªèº«
    context_.getGameState().setState(engine::core::State::Playing); // æ¢å¤æ¸¸æˆçŠ¶æ€
}

// "è¿”å›æ ‡é¢˜"æŒ‰é’®çš„å›è°ƒ
void MenuScene::onBackClicked() {
    // ä½¿ç”¨ Replace æ¸…ç©ºåœºæ™¯æ ˆï¼Œå¹¶åˆ‡æ¢åˆ° TitleScene
    scene_manager_.requestReplaceScene(std::make_unique<TitleScene>(context_, scene_manager_, session_data_));
}
```

### MenuScene èŒè´£

```
MenuScene ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MenuScene           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ init()             â”‚  â”‚
â”‚  â”‚ â€¢ setState(Paused) â”‚  â”‚ â† è¿›å…¥æ—¶æš‚åœ
â”‚  â”‚ â€¢ createUI()       â”‚  â”‚   åˆ›å»ºç•Œé¢
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ handleInput()      â”‚  â”‚
â”‚  â”‚ â€¢ æ£€æµ‹æš‚åœé”®       â”‚  â”‚ â† å†æŒ‰ESCæ¢å¤
â”‚  â”‚ â€¢ Pop + Playing    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æŒ‰é’®å›è°ƒ           â”‚  â”‚
â”‚  â”‚ â€¢ onResumeClicked()â”‚  â”‚ â† ç»§ç»­æ¸¸æˆ
â”‚  â”‚ â€¢ onSaveClicked()  â”‚  â”‚   ä¿å­˜æ¸¸æˆ
â”‚  â”‚ â€¢ onBackClicked()  â”‚  â”‚   è¿”å›æ ‡é¢˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŒ‰é’®åŠŸèƒ½è¯´æ˜

| æŒ‰é’® | åŠŸèƒ½ | æ“ä½œ | çŠ¶æ€å˜åŒ– |
|-----|------|------|---------|
| **ç»§ç»­æ¸¸æˆ** | æ¢å¤æ¸¸æˆ | Pop + setState(Playing) | Pausedâ†’Playing |
| **ä¿å­˜æ¸¸æˆ** | ä¿å­˜è¿›åº¦ | ä¿å­˜æ•°æ® | ä¿æŒPaused |
| **è¿”å›æ ‡é¢˜** | å›åˆ°ä¸»èœå• | Replace TitleScene | Pausedâ†’Title |
| **ESCé”®** | å¿«æ·æ¢å¤ | åŒç»§ç»­æ¸¸æˆ | Pausedâ†’Playing |

å½“ MenuScene åˆå§‹åŒ–æ—¶ï¼Œå®ƒåšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯**å°†å…¨å±€çŠ¶æ€è®¾ä¸º Paused**ã€‚å½“å®ƒè¢« Popï¼ˆé€šè¿‡ç‚¹å‡»"ç»§ç»­"æˆ–å†æŒ‰ä¸€æ¬¡æš‚åœé”®ï¼‰æ—¶ï¼Œå®ƒåˆè´Ÿè´£**å°†çŠ¶æ€æ”¹å› Playing**ã€‚

### çŠ¶æ€ç®¡ç†è´£ä»»

```
MenuScene çŠ¶æ€ç®¡ç†ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿›å…¥ MenuSceneï¼š     â”‚
â”‚ init()               â”‚
â”‚ setState(Paused) âœ…  â”‚
â”‚ â†’ æ¸¸æˆå†»ç»“           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¦»å¼€ MenuSceneï¼š     â”‚
â”‚ onResumeClicked()    â”‚
â”‚ setState(Playing) âœ… â”‚
â”‚ â†’ æ¸¸æˆæ¢å¤           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åœºæ™¯è´Ÿè´£çŠ¶æ€åˆ‡æ¢ï¼
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šè§¦å‘æš‚åœ

### ğŸ’¡ åœ¨ GameScene ä¸­è§¦å‘æš‚åœ

æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ GameScene ä¸­ç›‘å¬æš‚åœè¾“å…¥ï¼Œå¹¶è§¦å‘ MenuScene çš„å‹å…¥ã€‚

---

## 5. GameScene é›†æˆ

### src/game/scene/game_scene.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// GameScene åˆå§‹åŒ–æ—¶ï¼Œå°†çŠ¶æ€è®¾ä¸º Playing
void GameScene::init() {
    // ...
    spdlog::trace("GameScene åˆå§‹åŒ–å¼€å§‹...");
    context_.getGameState().setState(engine::core::State::Playing);
    // ...
}

// åœ¨ GameScene ä¸­å¤„ç†è¾“å…¥
void GameScene::handleInput() {
    Scene::handleInput();
    // æ£€æŸ¥æš‚åœåŠ¨ä½œ
    if (context_.getInputManager().isActionPressed("pause")) {
        spdlog::debug("åœ¨GameSceneä¸­æ£€æµ‹åˆ°æš‚åœåŠ¨ä½œï¼Œæ­£åœ¨æ¨é€MenuSceneã€‚");
        scene_manager_.requestPushScene(std::make_unique<MenuScene>(context_, scene_manager_, game_session_data_));
    }
}
```

### æš‚åœè§¦å‘æµç¨‹

```
æš‚åœè§¦å‘æµç¨‹ï¼š
    GameSceneè¿è¡Œ
    (çŠ¶æ€: Playing)
         â†“
    ç”¨æˆ·æŒ‰ESCé”®
         â†“
    handleInput()æ£€æµ‹åˆ°
         â†“
    requestPushScene(MenuScene)
         â†“
    MenuScene::init()
         â†“
    setState(Paused)
         â†“
    Scene::update()æ£€æµ‹çŠ¶æ€
         â†“
    è·³è¿‡ç‰©ç†å’Œç›¸æœºæ›´æ–°
         â†“
    æ¸¸æˆå†»ç»“ï¼
```

---

## 6. å®Œæ•´æš‚åœæµç¨‹

è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„æš‚åœæµç¨‹å°±é—­ç¯äº†ï¼š

### æš‚åœæµç¨‹è¯¦è§£

```
å®Œæ•´çš„æš‚åœ-æ¢å¤æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ¸¸æˆè¿›è¡Œä¸­            â”‚
â”‚    GameScene             â”‚
â”‚    çŠ¶æ€: Playing         â”‚
â”‚    ç‰©ç†ã€ç›¸æœºæ­£å¸¸æ›´æ–°    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æŒ‰ESC
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. è§¦å‘æš‚åœ              â”‚
â”‚    æ£€æµ‹åˆ°pauseé”®         â”‚
â”‚    Push MenuScene        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. MenuSceneåˆå§‹åŒ–       â”‚
â”‚    setState(Paused)      â”‚
â”‚    åˆ›å»ºæš‚åœUI            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æ¸¸æˆå†»ç»“              â”‚
â”‚    Scene::update()       â”‚
â”‚    æ£€æµ‹åˆ°Paused          â”‚
â”‚    è·³è¿‡ç‰©ç†å’Œç›¸æœºæ›´æ–°    â”‚
â”‚    GameSceneè¢«å†»ç»“       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ç”¨æˆ·æ“ä½œ              â”‚
â”‚    â€¢ ç‚¹å‡»"ç»§ç»­"          â”‚
â”‚    â€¢ æˆ–å†æŒ‰ESC           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. æ¢å¤æ¸¸æˆ              â”‚
â”‚    Pop MenuScene         â”‚
â”‚    setState(Playing)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. GameSceneæ¢å¤         â”‚
â”‚    æˆä¸ºæ ˆé¡¶ï¼Œé‡æ–°æ´»åŠ¨    â”‚
â”‚    Scene::update()       â”‚
â”‚    æ£€æµ‹åˆ°Playing         â”‚
â”‚    æ¢å¤ç‰©ç†å’Œç›¸æœºæ›´æ–°    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµç¨‹æ­¥éª¤è¡¨

| æ­¥éª¤ | åœºæ™¯ | çŠ¶æ€ | ç‰©ç†æ›´æ–° | ç›¸æœºæ›´æ–° | UIæ›´æ–° |
|-----|------|------|---------|---------|--------|
| **1. æ¸¸æˆä¸­** | GameScene | Playing | âœ… | âœ… | âœ… |
| **2. æŒ‰ESC** | GameScene | Playingâ†’è§¦å‘ | âœ… | âœ… | âœ… |
| **3. Push MenuScene** | MenuSceneå åŠ  | â†’Paused | â¸ï¸ | â¸ï¸ | âœ… |
| **4. æš‚åœä¸­** | MenuScene | Paused | â¸ï¸ | â¸ï¸ | âœ… |
| **5. ç‚¹å‡»ç»§ç»­** | MenuScene | Pausedâ†’è§¦å‘ | â¸ï¸ | â¸ï¸ | âœ… |
| **6. Pop MenuScene** | GameScene | â†’Playing | â¸ï¸ | â¸ï¸ | âœ… |
| **7. æ¢å¤æ¸¸æˆ** | GameScene | Playing | âœ… | âœ… | âœ… |

### åœºæ™¯å †æ ˆå˜åŒ–

```
åœºæ™¯å †æ ˆå˜åŒ–ï¼š
æ¸¸æˆä¸­ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GameScene    â”‚ â† Playing
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æŒ‰ESCåï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MenuScene    â”‚ â† Pausedï¼ˆæ´»åŠ¨ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ GameScene    â”‚ â† æš‚åœï¼ˆå†»ç»“ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»ç»§ç»­åï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GameScene    â”‚ â† Playingï¼ˆæ¢å¤ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… è¿è¡Œæµ‹è¯•

ç¼–è¯‘å¹¶è¿è¡Œæ¸¸æˆï¼š

```
æš‚åœç³»ç»Ÿæµ‹è¯•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. è¿›å…¥æ¸¸æˆ            â”‚
â”‚     GameSceneè¿è¡Œ       â”‚
â”‚     çŠ¶æ€: Playing       â”‚
â”‚     ğŸ‘¤ ç©å®¶å¯ç§»åŠ¨       â”‚
â”‚     â†“                   â”‚
â”‚  2. æŒ‰ESCé”®             â”‚
â”‚     MenuSceneå åŠ        â”‚
â”‚     çŠ¶æ€: Paused        â”‚
â”‚     ğŸ‘¤ ç©å®¶å†»ç»“ â¸ï¸      â”‚
â”‚     â†“                   â”‚
â”‚  3. æš‚åœèœå•æ˜¾ç¤º        â”‚
â”‚     [ç»§ç»­] [ä¿å­˜] [è¿”å›]â”‚
â”‚     å¯ä»¥äº¤äº’ âœ…         â”‚
â”‚     â†“                   â”‚
â”‚  4. ç‚¹å‡»"ç»§ç»­"          â”‚
â”‚     MenuSceneç§»é™¤       â”‚
â”‚     çŠ¶æ€: Playing       â”‚
â”‚     ğŸ‘¤ ç©å®¶æ¢å¤ç§»åŠ¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŠŸèƒ½æ£€æŸ¥æ¸…å•

```
æš‚åœåŠŸèƒ½æµ‹è¯•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… æŒ‰ESCæ˜¾ç¤ºèœå•     â”‚
â”‚ âœ… æ¸¸æˆå®Œå…¨å†»ç»“      â”‚
â”‚ âœ… ç‰©ç†åœæ­¢æ›´æ–°      â”‚
â”‚ âœ… ç›¸æœºåœæ­¢ç§»åŠ¨      â”‚
â”‚ âœ… UIæ­£å¸¸äº¤äº’        â”‚
â”‚ âœ… æŒ‰é’®åŠŸèƒ½æ­£å¸¸      â”‚
â”‚ âœ… ç‚¹å‡»ç»§ç»­æ¢å¤      â”‚
â”‚ âœ… å†æŒ‰ESCä¹Ÿæ¢å¤     â”‚
â”‚ âœ… è¿”å›æ ‡é¢˜æ­£å¸¸      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ç³»ç»Ÿæ¶æ„æ€»ç»“

### å®Œæ•´çš„æš‚åœç³»ç»Ÿæ¶æ„

```
æš‚åœç³»ç»Ÿå®Œæ•´æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      GameApp             â”‚ â† åº”ç”¨å±‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ GameState          â”‚  â”‚ â† çŠ¶æ€ç®¡ç† âœ¨
â”‚  â”‚ â€¢ Title            â”‚  â”‚
â”‚  â”‚ â€¢ Playing          â”‚  â”‚
â”‚  â”‚ â€¢ Paused           â”‚  â”‚
â”‚  â”‚ â€¢ GameOver         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ é›†æˆåˆ°
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Context             â”‚ â† ä¸Šä¸‹æ–‡å±‚
â”‚  getGameState()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ è®¿é—®
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Scene::update()     â”‚ â† åœºæ™¯å±‚
â”‚  if (isPlaying()) {      â”‚
â”‚    ç‰©ç†æ›´æ–°              â”‚
â”‚    ç›¸æœºæ›´æ–°              â”‚
â”‚  }                       â”‚
â”‚  UIæ›´æ–°ï¼ˆæ€»æ˜¯ï¼‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æ§åˆ¶
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ¸¸æˆä¸–ç•Œ            â”‚ â† æ¸¸æˆå±‚
â”‚  æ¡ä»¶æ›´æ–°                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…¨å±€çŠ¶æ€ï¼Œç²¾ç¡®æ§åˆ¶ï¼
```

### æ ¸å¿ƒæˆå°±

æˆ‘ä»¬æˆåŠŸåœ°ï¼š

1. âœ… **åˆ›å»ºäº†GameState**ï¼šå…¨å±€æ¸¸æˆçŠ¶æ€ç®¡ç†å™¨
2. âœ… **é›†æˆåˆ°Context**ï¼šå…¨å±€è®¿é—®çŠ¶æ€ä¿¡æ¯
3. âœ… **å®ç°æ¡ä»¶æ›´æ–°**ï¼šæ ¹æ®çŠ¶æ€æ§åˆ¶æ›´æ–°é€»è¾‘
4. âœ… **åˆ›å»ºäº†MenuScene**ï¼šåŠŸèƒ½å®Œæ•´çš„æš‚åœèœå•
5. âœ… **å®ç°çœŸæš‚åœ**ï¼šç‰©ç†å’Œç›¸æœºçœŸæ­£åœæ­¢
6. âœ… **ä¿æŒUIæ´»è·ƒ**ï¼šèœå•å¯ä»¥æ­£å¸¸äº¤äº’
7. âœ… **å®Œæ•´æµç¨‹é—­ç¯**ï¼šæš‚åœ-æ¢å¤æµç¨‹å®Œç¾

### çœŸæš‚åœ vs å‡æš‚åœ

```
æš‚åœå®ç°å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‡æš‚åœï¼ˆå·®ï¼‰ï¼š       â”‚
â”‚ â€¢ åªå åŠ èœå•UI      â”‚
â”‚ â€¢ æ¸¸æˆä»åœ¨è¿è¡Œ      â”‚
â”‚ â€¢ æ•Œäººç»§ç»­æ”»å‡»      â”‚
â”‚ â€¢ ç‰©ç†ç»§ç»­è®¡ç®—      â”‚
â”‚ âŒ ä¸æ˜¯çœŸæš‚åœ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çœŸæš‚åœï¼ˆå¥½ï¼‰ï¼š       â”‚
â”‚ â€¢ çŠ¶æ€ç®¡ç†æ§åˆ¶      â”‚
â”‚ â€¢ ç‰©ç†åœæ­¢æ›´æ–°      â”‚
â”‚ â€¢ ç›¸æœºåœæ­¢ç§»åŠ¨      â”‚
â”‚ â€¢ æ¸¸æˆå®Œå…¨å†»ç»“      â”‚
â”‚ âœ… çœŸæ­£çš„æš‚åœ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GameStateè®©æš‚åœ"çœŸå®"ï¼
```

### çŠ¶æ€ç®¡ç†çš„ä¼˜åŠ¿

| æ–¹é¢ | æ— çŠ¶æ€ç®¡ç† | æœ‰GameState |
|-----|-----------|------------|
| **æš‚åœæ§åˆ¶** | éš¾ä»¥å®ç° âŒ | ç²¾ç¡®æ§åˆ¶ âœ… |
| **ä»£ç æ¸…æ™°åº¦** | é€»è¾‘æ··ä¹± âŒ | æ¸…æ™°æ˜äº† âœ… |
| **å¯æ‰©å±•æ€§** | éš¾ä»¥æ‰©å±• âŒ | æ˜“äºæ‰©å±• âœ… |
| **çŠ¶æ€æŸ¥è¯¢** | ä¸æ–¹ä¾¿ âŒ | ä¾¿æ·æ–¹æ³• âœ… |
| **å¤šåœºæ™¯åè°ƒ** | å›°éš¾ âŒ | ç»Ÿä¸€ç®¡ç† âœ… |

### è®¾è®¡æ¨¡å¼åº”ç”¨

```
æœ¬è¯¾æ¶‰åŠçš„è®¾è®¡æ¨¡å¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. çŠ¶æ€æ¨¡å¼ â­â­â­   â”‚
â”‚    GameState         â”‚
â”‚    ç®¡ç†æ¸¸æˆçŠ¶æ€      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. å•ä¾‹æ¨¡å¼          â”‚
â”‚    å…¨å±€çŠ¶æ€è®¿é—®      â”‚
â”‚    é€šè¿‡Context       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ç­–ç•¥æ¨¡å¼          â”‚
â”‚    æ¡ä»¶å¼æ›´æ–°        â”‚
â”‚    ä¸åŒè¡Œä¸ºç­–ç•¥      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. è§‚å¯Ÿè€…æ¨¡å¼        â”‚
â”‚    çŠ¶æ€å˜åŒ–é€šçŸ¥      â”‚
â”‚    åœºæ™¯å“åº”          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š æ€»ç»“

é€šè¿‡å¼•å…¥ **GameState** è¿™ä¸€å…¨å±€çŠ¶æ€ç®¡ç†å™¨ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå¥å£®ä¸”é€»è¾‘æ¸…æ™°çš„æš‚åœç³»ç»Ÿã€‚è¿™ä¸ªç³»ç»Ÿä¸ä»…ä»…æ˜¯UIçš„å åŠ ï¼Œè€Œæ˜¯**çœŸæ­£ä»å¼•æ“å±‚é¢æ§åˆ¶äº†æ¸¸æˆæ ¸å¿ƒé€»è¾‘çš„æ‰§è¡Œ**ã€‚

**å…³é”®è¦ç‚¹ï¼š**
- ğŸ® **GameState**ï¼šå…¨å±€æ¸¸æˆçŠ¶æ€ç®¡ç†
- ğŸŒ **Contexté›†æˆ**ï¼šå…¨å±€è®¿é—®çŠ¶æ€
- â¸ï¸ **æ¡ä»¶æ›´æ–°**ï¼šæ ¹æ®çŠ¶æ€æ§åˆ¶æ›´æ–°
- ğŸ¯ **çœŸæš‚åœ**ï¼šç‰©ç†å’Œç›¸æœºçœŸæ­£åœæ­¢
- ğŸ”„ **UIæ´»è·ƒ**ï¼šèœå•ä¿æŒäº¤äº’
- ğŸ“± **MenuScene**ï¼šå®Œæ•´çš„æš‚åœèœå•
- ğŸ”— **å®Œæ•´æµç¨‹**ï¼šæš‚åœ-æ¢å¤é—­ç¯

> ğŸ’¡ **è®¾è®¡å“²å­¦**ï¼šåœ¨æœ¬èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†å…¨å±€æ¸¸æˆçŠ¶æ€ç®¡ç†çš„æ¦‚å¿µã€‚GameState ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„æšä¸¾å˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸­å¿ƒåŒ–çš„çŠ¶æ€ç®¡ç†å™¨ï¼Œè´Ÿè´£åè°ƒæ•´ä¸ªæ¸¸æˆçš„å®è§‚è¡Œä¸ºã€‚é€šè¿‡å°† GameState é›†æˆåˆ° Context ä¸­ï¼Œæˆ‘ä»¬è®©æ‰€æœ‰æ¨¡å—éƒ½èƒ½æ„ŸçŸ¥å½“å‰çš„æ¸¸æˆçŠ¶æ€ï¼Œå¹¶æ®æ­¤åšå‡ºç›¸åº”çš„è¡Œä¸ºè°ƒæ•´ã€‚æ¡ä»¶å¼æ›´æ–°æ˜¯å®ç°çœŸæš‚åœçš„å…³é”®â€”â€”åªåœ¨ Playing çŠ¶æ€ä¸‹æ›´æ–°ç‰©ç†å’Œç›¸æœºï¼Œè€Œ UI å§‹ç»ˆä¿æŒæ´»è·ƒä»¥æ”¯æŒèœå•äº¤äº’ã€‚è¿™ç§è®¾è®¡æ¸…æ™°ã€å¥å£®ï¼Œä¸”å…·æœ‰æå¼ºçš„æ‰©å±•æ€§ã€‚

**GameState çš„æ‰©å±•æ€§**ï¼š

```
GameState æ‰©å±•ä»·å€¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å½“å‰å®ç°ï¼ˆ4çŠ¶æ€ï¼‰ï¼š  â”‚
â”‚ â€¢ Title             â”‚
â”‚ â€¢ Playing           â”‚
â”‚ â€¢ Paused            â”‚
â”‚ â€¢ GameOver          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æœªæ¥æ‰©å±•ï¼ˆè½»æ¾ï¼‰ï¼š   â”‚
â”‚ + Cutscene          â”‚ â† è¿‡åœºåŠ¨ç”»
â”‚ + Loading           â”‚ â† åŠ è½½ç•Œé¢
â”‚ + Dialog            â”‚ â† å¯¹è¯ç³»ç»Ÿ
â”‚ + Tutorial          â”‚ â† æ•™ç¨‹æ¨¡å¼
â”‚ â†’ åªéœ€æ·»åŠ æšä¸¾ï¼    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¶æ„æ”¯æŒæ— é™æ‰©å±•ï¼
```

è¿™å¥— GameState æ¶æ„å…·æœ‰æå¼ºçš„æ‰©å±•æ€§ã€‚åœ¨æœªæ¥ï¼Œå½“æˆ‘ä»¬éœ€è¦å®ç°"æ¸¸æˆç»“æŸ"ã€"è¿‡åœºåŠ¨ç”»"ç­‰å…¶ä»–å®è§‚çŠ¶æ€æ—¶ï¼Œåªéœ€åœ¨ `State` æšä¸¾ä¸­æ·»åŠ æ–°çŠ¶æ€ï¼Œå¹¶åœ¨ç›¸åº”çš„é€»è¾‘ç‚¹è¿›è¡Œåˆ¤æ–­å’Œåˆ‡æ¢å³å¯ï¼Œ**æ•´ä¸ªé¡¹ç›®çš„ç»“æ„å°†å› æ­¤è€Œæ›´åŠ æ¸…æ™°å’Œç¨³å›º**ã€‚

---

## ğŸš€ ä¸‹ä¸€æ­¥å±•æœ›

æˆ‘ä»¬å·²ç»æœ‰äº†å®Œæ•´çš„æš‚åœç³»ç»Ÿï¼Œæ¸¸æˆçš„åŸºæœ¬æµç¨‹ä¹Ÿå·²ç»å®Œå–„ã€‚æœ€åä¸€æ­¥å°±æ˜¯å®Œæˆæ¸¸æˆçš„æ”¶å°¾å·¥ä½œã€‚

- â“ å¦‚ä½•å®ç°æ¸¸æˆç»“æŸåœºæ™¯ï¼Ÿ
- â“ å¦‚ä½•æ˜¾ç¤ºæœ€ç»ˆå¾—åˆ†ï¼Ÿ
- â“ å¦‚ä½•ä¿å­˜æœ€é«˜åˆ†ï¼Ÿ
- â“ å¦‚ä½•å®Œå–„æ¸¸æˆå¾ªç¯ï¼Ÿ

åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæ¸¸æˆç»“æŸåœºæ™¯ï¼Œå®Œæˆæ•´ä¸ªæ¸¸æˆçš„æœ€åä¸€å—æ‹¼å›¾ã€‚

å‡†å¤‡å¥½å®Œæˆä½ çš„æ¸¸æˆå§ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼ğŸ®ğŸŒŸ