# éŸ³é¢‘å¼•æ“ä¸éŸ³é¢‘ç»„ä»¶

<div class="video-container">
  <div id="bilibili" class="video-content">
    <!-- Bç«™åµŒå…¥ï¼šä½¿ç”¨ https æ˜ç¡®åè®®ï¼ˆé¿å… file:// æˆ– http å¯¼è‡´è¢«æµè§ˆå™¨æ‹¦æˆªï¼‰ -->
    <iframe
      class="video-frame"
      src="https://player.bilibili.com/player.html?bvid=BV1HubKzkExv&page=1&autoplay=0&danmaku=0&high_quality=1"
      width="100%"
      height="480"
      scrolling="no"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>
</div>

[åœ¨ Bilibili ä¸Šè§‚çœ‹](https://www.bilibili.com/video/BV1HubKzkExv)

## ğŸ“Œ é—®é¢˜èƒŒæ™¯

æ¬¢è¿æ¥åˆ°ã€ŠC++æ¸¸æˆå¼€å‘ä¹‹æ—…ã€‹çš„ç¬¬27è¯¾ï¼åœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„"é˜³å…‰å²›"å·²ç»æ˜¯ä¸€ä¸ªè§†è§‰å’Œäº¤äº’éƒ½æ¯”è¾ƒä¸°å¯Œçš„ä¸–ç•Œäº†ï¼Œä½†å®ƒè¿˜æ˜¯ **æ— å£°çš„**ã€‚ä¸€ä¸ªä¼˜ç§€çš„æ¸¸æˆï¼ŒéŸ³æ•ˆå’ŒéŸ³ä¹æ˜¯å…¶çµé­‚çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚å®ƒä»¬èƒ½å¤Ÿæå¤§åœ°å¢å¼ºæ¸¸æˆçš„æ²‰æµ¸æ„Ÿã€åé¦ˆæ„Ÿå’Œè¶£å‘³æ€§ã€‚

### âš ï¸ å½“å‰çš„é—®é¢˜

```
æ— å£°çš„æ¸¸æˆä¸–ç•Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ‘¤ ç©å®¶è·³è·ƒï¼ˆæ— å£°ï¼‰    â”‚
â”‚   ğŸ¸ æ•Œäººç§»åŠ¨ï¼ˆæ— å£°ï¼‰    â”‚
â”‚   ğŸ’ æ”¶é›†é“å…·ï¼ˆæ— å£°ï¼‰    â”‚
â”‚   ğŸ’¥ è¸©æ­»æ•Œäººï¼ˆæ— å£°ï¼‰    â”‚
â”‚   ğŸµ èƒŒæ™¯éŸ³ä¹ï¼ˆæ— ï¼‰      â”‚
â”‚                          â”‚
â”‚ âŒ ç¼ºå°‘å¬è§‰åé¦ˆ          â”‚
â”‚ âŒ æ²‰æµ¸æ„Ÿä¸è¶³            â”‚
â”‚ âŒ æ¸¸æˆä½“éªŒå•è°ƒ          â”‚
â”‚ âŒ ç¼ºå°‘æƒ…æ„Ÿè¡¨è¾¾          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| é—®é¢˜ | è¯´æ˜ | å½±å“ |
|------|------|------|
| **æ— éŸ³æ•ˆåé¦ˆ** | ç©å®¶åŠ¨ä½œæ²¡æœ‰å£°éŸ³ | ç¼ºå°‘å³æ—¶åé¦ˆ |
| **æ— èƒŒæ™¯éŸ³ä¹** | æ¸¸æˆä¸–ç•Œè¿‡äºå®‰é™ | æ°›å›´æ„Ÿä¸è¶³ |
| **æ²‰æµ¸æ„Ÿå·®** | åªæœ‰è§†è§‰æ²¡æœ‰å¬è§‰ | ä½“éªŒä¸å®Œæ•´ |
| **éš¾ä»¥ç®¡ç†** | ç¼ºå°‘éŸ³é¢‘ç³»ç»Ÿ | æ— æ³•ç»Ÿä¸€æ§åˆ¶ |

### ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šå®Œæ•´çš„éŸ³é¢‘ç³»ç»Ÿ

<img src="https://theorhythm.top/gamedev/SL/SL.081.webp" alt="éŸ³é¢‘ç³»ç»Ÿ" style="display: block; margin: auto; width: 700px;" />

**æ ¸å¿ƒæ€æƒ³**ï¼š
1. æ„å»ºå¼•æ“å±‚éŸ³é¢‘æ¨¡å—ï¼ˆAudioPlayerï¼‰
2. åˆ›å»ºéŸ³é¢‘ç»„ä»¶ï¼ˆAudioComponentï¼‰
3. å®ç°æ•°æ®é©±åŠ¨çš„éŸ³æ•ˆé…ç½®
4. ä¸ºæ¸¸æˆå„å¤„æ·»åŠ éŸ³æ•ˆå’ŒéŸ³ä¹

```
éŸ³é¢‘ç³»ç»Ÿæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SDL_mixer      â”‚ â† åº•å±‚éŸ³é¢‘åº“
â”‚   (Cé£æ ¼API)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ å°è£…
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AudioPlayer     â”‚ â† å¼•æ“å±‚
â”‚  (ç»Ÿä¸€æ¥å£)       â”‚   æ’­æ”¾æ§åˆ¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Audio   â”‚â”‚Context â”‚ â† ä½¿ç”¨è€…
â”‚Comp    â”‚â”‚ç›´æ¥è°ƒç”¨â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ æœ¬è¯¾ç›®æ ‡

| ç›®æ ‡ | è¯´æ˜ |
|------|------|
| **æ„å»ºå¼•æ“å±‚éŸ³é¢‘æ¨¡å—** | åˆ›å»º AudioPlayer ç®¡ç†éŸ³æ•ˆå’ŒéŸ³ä¹ |
| **åˆ›å»ºéŸ³é¢‘ç»„ä»¶** | è®¾è®¡ AudioComponent è®©å¯¹è±¡æ’­æ”¾éŸ³æ•ˆ |
| **å®ç°æ•°æ®é©±åŠ¨** | é€šè¿‡ Tiled é…ç½®éŸ³é¢‘ï¼ŒåŠ¨æ€åŠ è½½ |
| **åœ¨æ¸¸æˆä¸­å‘å£°** | ä¸ºå„ç§è¡Œä¸ºå’Œäº‹ä»¶æ·»åŠ éŸ³æ•ˆ |

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼•æ“å±‚éŸ³é¢‘ç³»ç»Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä½äºå¼•æ“å±‚çš„æ ¸å¿ƒæ¨¡å—ï¼Œä¸“é—¨è´Ÿè´£ä¸åº•å±‚éŸ³é¢‘åº“ï¼ˆæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ SDL_mixerï¼‰æ‰“äº¤é“ã€‚

---

## 1. éŸ³é¢‘æ’­æ”¾å™¨ï¼šAudioPlayer

è¿™ä¸ªæ¨¡å—å°±æ˜¯ `AudioPlayer`ï¼Œå®ƒå°†ä½œä¸ºæ‰€æœ‰éŸ³é¢‘æ’­æ”¾çš„ç»Ÿä¸€å‡ºå£ã€‚

### AudioPlayer çš„èŒè´£

```
AudioPlayer æ ¸å¿ƒèŒè´£ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éŸ³æ•ˆç®¡ç†             â”‚
â”‚ â€¢ æ’­æ”¾çŸ­ä¿ƒéŸ³æ•ˆ(Chunk)â”‚
â”‚ â€¢ å¤šé€šé“æ··éŸ³         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ éŸ³ä¹ç®¡ç†             â”‚
â”‚ â€¢ æ’­æ”¾èƒŒæ™¯éŸ³ä¹(Music)â”‚
â”‚ â€¢ å¾ªç¯ã€æ·¡å…¥æ·¡å‡º     â”‚
â”‚ â€¢ æš‚åœã€ç»§ç»­ã€åœæ­¢   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ éŸ³é‡æ§åˆ¶             â”‚
â”‚ â€¢ å…¨å±€éŸ³æ•ˆéŸ³é‡       â”‚
â”‚ â€¢ èƒŒæ™¯éŸ³ä¹éŸ³é‡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| åŠŸèƒ½ç±»åˆ« | è¯´æ˜ | ç‰¹ç‚¹ |
|---------|------|------|
| **éŸ³æ•ˆï¼ˆSound/Chunkï¼‰** | çŸ­ä¿ƒçš„éŸ³æ•ˆ | å¯åŒæ—¶æ’­æ”¾å¤šä¸ª |
| **éŸ³ä¹ï¼ˆMusicï¼‰** | èƒŒæ™¯éŸ³ä¹ | åŒæ—¶åªèƒ½æ’­æ”¾ä¸€ä¸ª |
| **éŸ³é‡æ§åˆ¶** | è°ƒèŠ‚éŸ³é‡ | 0.0 ~ 1.0 èŒƒå›´ |

### src/engine/audio/audio_player.hï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰

```cpp
#pragma once
#include <string>

namespace engine::resource {
    class ResourceManager;
}

struct Mix_Chunk;
struct Mix_Music;

namespace engine::audio {

/**
 * @brief ç”¨äºæ§åˆ¶éŸ³é¢‘æ’­æ”¾çš„ç±»ã€‚
 * æä¾›æ’­æ”¾éŸ³æ•ˆå’ŒéŸ³ä¹çš„æ–¹æ³•ï¼Œä½¿ç”¨ç”± ResourceManager ç®¡ç†çš„èµ„æºã€‚
 */
class AudioPlayer final{
private:
    engine::resource::ResourceManager* resource_manager_;
    std::string current_music_;

public:
    explicit AudioPlayer(engine::resource::ResourceManager* resource_manager);
    ~AudioPlayer();

    // åˆ é™¤æ‹·è´å’Œç§»åŠ¨æ„é€ /èµ‹å€¼å‡½æ•°
    AudioPlayer(const AudioPlayer&) = delete;
    AudioPlayer& operator=(const AudioPlayer&) = delete;
    AudioPlayer(AudioPlayer&&) = delete;
    AudioPlayer& operator=(AudioPlayer&&) = delete;

    // --- æ’­æ”¾æ§åˆ¶æ–¹æ³• --- 
    int playSound(const std::string& sound_path, int channel = -1);
    bool playMusic(const std::string& music_path, int loops = -1, int fade_in_ms = 0);
    void stopMusic(int fade_out_ms = 0);
    void pauseMusic();
    void resumeMusic();

    // --- éŸ³é‡æ§åˆ¶æ–¹æ³• ---
    void setSoundVolume(float volume, int channel = -1);
    void setMusicVolume(float volume);
    float getMusicVolume();
    float getSoundVolume(int channel = -1);
};

} // namespace engine::audio
```

### ğŸ’¡ è®¾è®¡äº®ç‚¹ï¼šå•ä¸€èŒè´£åŸåˆ™

```cpp
explicit AudioPlayer(engine::resource::ResourceManager* resource_manager);
```

**AudioPlayer çš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ª ResourceManager æŒ‡é’ˆ**ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„éŸ³é¢‘æ’­æ”¾ä¸ç›´æ¥è´Ÿè´£åŠ è½½æ–‡ä»¶ï¼Œè€Œæ˜¯å§”æ‰˜ç»™å·²ç»å­˜åœ¨çš„èµ„æºç®¡ç†å™¨ã€‚

```
èŒè´£åˆ†ç¦»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ResourceManager      â”‚
â”‚ â€¢ åŠ è½½éŸ³é¢‘æ–‡ä»¶       â”‚
â”‚ â€¢ ç¼“å­˜éŸ³é¢‘èµ„æº       â”‚
â”‚ â€¢ ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æä¾›èµ„æº
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioPlayer          â”‚
â”‚ â€¢ æ’­æ”¾éŸ³é¢‘           â”‚
â”‚ â€¢ æ§åˆ¶éŸ³é‡           â”‚
â”‚ â€¢ ç®¡ç†æ’­æ”¾çŠ¶æ€       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®Œç¾ä½“ç°å•ä¸€èŒè´£åŸåˆ™ï¼
```

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **èŒè´£æ¸…æ™°** | åŠ è½½ä¸æ’­æ”¾åˆ†ç¦» |
| **æ˜“äºæµ‹è¯•** | å¯ä»¥æ¨¡æ‹Ÿ ResourceManager |
| **é«˜å†…èšä½è€¦åˆ** | æ¨¡å—é—´ä¾èµ–æ¸…æ™° |
| **å¯å¤ç”¨æ€§å¼º** | å¯ç”¨äºå…¶ä»–é¡¹ç›® |

### æ¥å£æ–¹æ³•è¯´æ˜

| æ–¹æ³• | å‚æ•° | è¯´æ˜ |
|------|------|------|
| **playSound** | `sound_path, channel` | æ’­æ”¾éŸ³æ•ˆï¼Œè¿”å›æ’­æ”¾é€šé“ |
| **playMusic** | `music_path, loops, fade_in_ms` | æ’­æ”¾éŸ³ä¹ï¼Œæ”¯æŒæ·¡å…¥ |
| **stopMusic** | `fade_out_ms` | åœæ­¢éŸ³ä¹ï¼Œæ”¯æŒæ·¡å‡º |
| **pauseMusic** | æ—  | æš‚åœéŸ³ä¹ |
| **resumeMusic** | æ—  | ç»§ç»­éŸ³ä¹ |
| **setMusicVolume** | `volume (0.0~1.0)` | è®¾ç½®éŸ³ä¹éŸ³é‡ |
| **setSoundVolume** | `volume, channel` | è®¾ç½®éŸ³æ•ˆéŸ³é‡ |

---

## 2. AudioPlayer å®ç°

æ¥ç€æ˜¯å®ƒçš„å®ç°ã€‚

### src/engine/audio/audio_player.cppï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰

```cpp
#include "audio_player.h"
#include "../resource/resource_manager.h"
#include <SDL3_mixer/SDL_mixer.h> 
#include <spdlog/spdlog.h>
#include <glm/common.hpp>

namespace engine::audio {

AudioPlayer::AudioPlayer(engine::resource::ResourceManager* resource_manager)
    : resource_manager_(resource_manager) {
    if (!resource_manager_) {
        throw std::runtime_error("AudioPlayer æ„é€ å¤±è´¥: æä¾›çš„ ResourceManager æŒ‡é’ˆä¸ºç©ºã€‚");
    }
}

int AudioPlayer::playSound(const std::string& sound_path, int channel) {
    // é€šè¿‡ ResourceManager è·å–èµ„æº
    Mix_Chunk* chunk = resource_manager_->getSound(sound_path); 
    if (!chunk) {
        spdlog::error("AudioPlayer: æ— æ³•è·å–éŸ³æ•ˆ '{}' æ’­æ”¾ã€‚", sound_path);
        return -1;
    }

    // æ’­æ”¾éŸ³æ•ˆ
    int played_channel = Mix_PlayChannel(channel, chunk, 0);    
    if (played_channel == -1) {
        spdlog::error("AudioPlayer: æ— æ³•æ’­æ”¾éŸ³æ•ˆ '{}': {}", sound_path, SDL_GetError());
    }
    return played_channel;
}

bool AudioPlayer::playMusic(const std::string& music_path, int loops, int fade_in_ms) {
    // å¦‚æœå½“å‰éŸ³ä¹å·²ç»åœ¨æ’­æ”¾ï¼Œåˆ™ä¸é‡å¤æ’­æ”¾
    if (music_path == current_music_) return true;      
    current_music_ = music_path;
    Mix_Music* music = resource_manager_->getMusic(music_path);
    if (!music) {
        spdlog::error("AudioPlayer: æ— æ³•è·å–éŸ³ä¹ '{}' æ’­æ”¾ã€‚", music_path);
        return false;
    }

    Mix_HaltMusic();        // åœæ­¢ä¹‹å‰çš„éŸ³ä¹

    bool result = false;
    if (fade_in_ms > 0) {
         result = Mix_FadeInMusic(music, loops, fade_in_ms);    // æ·¡å…¥æ’­æ”¾éŸ³ä¹
    } else {
         result = Mix_PlayMusic(music, loops);
    }

    if (!result) {
        spdlog::error("AudioPlayer: æ— æ³•æ’­æ”¾éŸ³ä¹ '{}': {}", music_path, SDL_GetError());
    }
    return result;
}

// éŸ³é‡è®¾ç½®å‡½æ•°ï¼Œä¾‹å¦‚ï¼š
void AudioPlayer::setMusicVolume(float volume) {
    // å°†æµ®ç‚¹éŸ³é‡(0-1)è½¬æ¢ä¸ºSDL_mixerçš„éŸ³é‡(0-128)
    int sdl_volume = static_cast<int>(glm::max(0.0f, glm::min(1.0f, volume)) * MIX_MAX_VOLUME);
    Mix_VolumeMusic(sdl_volume);
}
// ... å…¶ä»–æ–¹æ³•çš„å®ç° ...
}
```

### æ ¸å¿ƒåŠŸèƒ½è§£æ

#### playSound æµç¨‹

```
playSound å·¥ä½œæµç¨‹ï¼š
    â†“
1. ä» ResourceManager è·å–éŸ³æ•ˆ
    getSound(sound_path)
    â†“
2. æ£€æŸ¥èµ„æºæ˜¯å¦æœ‰æ•ˆ
    if (!chunk) return -1
    â†“
3. è°ƒç”¨ SDL_mixer æ’­æ”¾
    Mix_PlayChannel(channel, chunk, 0)
    â†“
4. è¿”å›æ’­æ”¾é€šé“å·
    (ç”¨äºåç»­æ§åˆ¶)
```

#### playMusic æµç¨‹

```
playMusic å·¥ä½œæµç¨‹ï¼š
    â†“
1. æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ’­æ”¾åŒä¸€éŸ³ä¹
    if (music_path == current_music_)
    â†“
2. ä» ResourceManager è·å–éŸ³ä¹
    getMusic(music_path)
    â†“
3. åœæ­¢ä¹‹å‰çš„éŸ³ä¹
    Mix_HaltMusic()
    â†“
4. æ ¹æ®å‚æ•°é€‰æ‹©æ’­æ”¾æ–¹å¼
    â”œâ”€ fade_in_ms > 0 â†’ æ·¡å…¥æ’­æ”¾
    â””â”€ å¦åˆ™ â†’ ç›´æ¥æ’­æ”¾
    â†“
5. è®°å½•å½“å‰æ’­æ”¾çš„éŸ³ä¹
    current_music_ = music_path
```

### éŸ³é‡è½¬æ¢

```cpp
// å°†æµ®ç‚¹éŸ³é‡(0-1)è½¬æ¢ä¸ºSDL_mixerçš„éŸ³é‡(0-128)
int sdl_volume = static_cast<int>(glm::max(0.0f, glm::min(1.0f, volume)) * MIX_MAX_VOLUME);
```

**éŸ³é‡èŒƒå›´è½¬æ¢**ï¼š

| å±‚çº§ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|
| **æ¸¸æˆå±‚** | 0.0 ~ 1.0 | æµ®ç‚¹æ•°ï¼Œç›´è§‚æ˜“ç”¨ |
| **SDL_mixer** | 0 ~ 128 | æ•´æ•°ï¼Œåº•å±‚API |

```
éŸ³é‡è½¬æ¢ç¤ºä¾‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¸¸æˆå±‚ â†’ SDL_mixer  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0.0 â†’ 0 (é™éŸ³)      â”‚
â”‚ 0.5 â†’ 64 (50%)      â”‚
â”‚ 1.0 â†’ 128 (æœ€å¤§)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ’¡ C++å°è£…çš„ä¼˜åŠ¿

**AudioPlayer å°† SDL_mixer é‚£äº›Cé£æ ¼çš„ã€éœ€è¦å¤„ç†å„ç§æŒ‡é’ˆå’Œè¿”å›ç çš„å‡½æ•°ï¼Œå°è£…æˆäº†ç®€æ´ã€æ˜“ç”¨çš„C++æ¥å£**ã€‚

```
Cé£æ ¼ vs C++å°è£…ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SDL_mixerï¼ˆCé£æ ¼ï¼‰ï¼š â”‚
â”‚ Mix_Chunk* chunk =  â”‚
â”‚   Mix_LoadWAV(path);â”‚
â”‚ if (!chunk) { ... } â”‚
â”‚ Mix_PlayChannel(    â”‚
â”‚   -1, chunk, 0);    â”‚
â”‚ éœ€è¦æ‰‹åŠ¨ç®¡ç†èµ„æº    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioPlayerï¼ˆC++ï¼‰ï¼š â”‚
â”‚ audio_player.       â”‚
â”‚   playSound(path);  â”‚
â”‚                     â”‚
â”‚ ç®€æ´ã€å®‰å…¨ã€æ˜“ç”¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šå¼•æ“é›†æˆä¸ç»„ä»¶åŒ–

å’Œæ¸²æŸ“å™¨ã€ç‰©ç†å¼•æ“ä¸€æ ·ï¼ŒAudioPlayer ä¹Ÿæ˜¯å¼•æ“çš„æ ¸å¿ƒæœåŠ¡ä¹‹ä¸€ã€‚æˆ‘ä»¬éœ€è¦åœ¨ GameApp ä¸­åˆ›å»ºå®ƒçš„å®ä¾‹ï¼Œå¹¶å°†å…¶åŠ å…¥åˆ° Context ä¸­ï¼Œä»¥ä¾¿æ¸¸æˆå„å¤„éƒ½èƒ½æ–¹ä¾¿åœ°è®¿é—®å®ƒã€‚

---

## 3. é›†æˆåˆ°å¼•æ“æ ¸å¿ƒ

### åœ¨ GameApp ä¸­æ–°å¢ AudioPlayer å®ä¾‹

#### src/engine/core/game_app.hï¼ˆæ›´æ–°ï¼‰

```cpp
// ...
namespace engine::audio {
class AudioPlayer;
}

class GameApp {
    // ...
    std::unique_ptr<engine::physics::PhysicsEngine> physics_engine_;
    std::unique_ptr<engine::audio::AudioPlayer> audio_player_;
    // ...
private:
    // ...
    [[nodiscard]] bool initResourceManager();
    [[nodiscard]] bool initAudioPlayer();
    [[nodiscard]] bool initRenderer();
    // ...
};
```

### åœ¨ Context ä¸­åŠ å…¥ AudioPlayer çš„å¼•ç”¨

#### src/engine/core/context.hï¼ˆæ›´æ–°ï¼‰

```cpp
// ...
namespace engine::audio {
    class AudioPlayer;
}

class Context {
private:
    // ...
    engine::physics::PhysicsEngine& physics_engine_;
    engine::audio::AudioPlayer& audio_player_;
public:
    Context(/*...*/, engine::audio::AudioPlayer& audio_player);
    // ...
    engine::audio::AudioPlayer& getAudioPlayer() const { return audio_player_; }
};
```

### å¼•æ“æ ¸å¿ƒæœåŠ¡æ€»è§ˆ

```
å¼•æ“æ ¸å¿ƒæœåŠ¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      GameApp         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ ResourceManager    â”‚ â† èµ„æºç®¡ç†
â”‚ â€¢ Renderer           â”‚ â† æ¸²æŸ“
â”‚ â€¢ PhysicsEngine      â”‚ â† ç‰©ç†
â”‚ â€¢ AudioPlayer        â”‚ â† éŸ³é¢‘ï¼ˆæ–°å¢ï¼‰âœ¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Context         â”‚
â”‚  (å…¨å±€è®¿é—®æ¥å£)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç°åœ¨ï¼Œæˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ªå…¨å±€å¯è®¿é—®çš„éŸ³é¢‘æ’­æ”¾å™¨**ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†è®©æ¯ä¸ª GameObject éƒ½èƒ½ç®¡ç†è‡ªå·±çš„å£°éŸ³ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª `AudioComponent`ã€‚

---

## 4. éŸ³é¢‘ç»„ä»¶ï¼šAudioComponent

ä¸ºäº†è®©æ¯ä¸ªæ¸¸æˆå¯¹è±¡éƒ½èƒ½ç®¡ç†è‡ªå·±çš„éŸ³æ•ˆï¼Œæˆ‘ä»¬åˆ›å»º `AudioComponent`ã€‚

### src/engine/component/audio_component.hï¼ˆæ–°å»ºæ–‡ä»¶ï¼‰

```cpp
#pragma once
#include "component.h"
#include <string>
#include <unordered_map>

namespace engine::audio {
    class AudioPlayer;
}

namespace engine::render {
    class Camera;
}

namespace engine::component {
    class TransformComponent;

class AudioComponent final: public Component {
private:
    engine::audio::AudioPlayer* audio_player_;
    engine::render::Camera* camera_;
    engine::component::TransformComponent* transform_ = nullptr;

    // éŸ³æ•ˆid åˆ° è·¯å¾„çš„æ˜ å°„è¡¨
    std::unordered_map<std::string, std::string> sound_id_to_path_; 

public:
    AudioComponent(engine::audio::AudioPlayer* audio_player, engine::render::Camera* camera);
    
    void playSound(const std::string& sound_id, int channel = -1, bool use_spatial = false);
    void addSound(const std::string& sound_id, const std::string& sound_path);

private:
    void init() override;
    void update(float, engine::core::Context&) override {}
};
}
```

### ğŸ’¡ è®¾è®¡äº®ç‚¹ï¼šé€»è¾‘IDä¸èµ„æºè·¯å¾„è§£è€¦

```cpp
std::unordered_map<std::string, std::string> sound_id_to_path_;
```

**AudioComponent å¼•å…¥äº†ä¸€ä¸ªéå¸¸é‡è¦çš„è®¾è®¡â€”â€”é€»è¾‘IDä¸èµ„æºè·¯å¾„çš„è§£è€¦**ã€‚

```
é€»è¾‘IDæ˜ å°„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sound_id_to_path_    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ "jump" â†’ "assets/    â”‚
â”‚   audio/jump.mp3"    â”‚
â”‚                      â”‚
â”‚ "hurt" â†’ "assets/    â”‚
â”‚   audio/hurt.mp3"    â”‚
â”‚                      â”‚
â”‚ "dead" â†’ "assets/    â”‚
â”‚   audio/dead.mp3"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿**ï¼š

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **ä»£ç ç®€æ´** | ä½¿ç”¨ `"jump"` è€Œä¸æ˜¯å®Œæ•´è·¯å¾„ |
| **æ˜“äºæ›¿æ¢** | åªéœ€ä¿®æ”¹æ˜ å°„è¡¨ï¼Œæ— éœ€æ”¹ä»£ç  |
| **é…ç½®çµæ´»** | æ”¯æŒæ•°æ®é©±åŠ¨é…ç½® |
| **å¤šè¯­è¨€æ”¯æŒ** | å¯è½»æ¾åˆ‡æ¢ä¸åŒè¯­è¨€çš„éŸ³æ•ˆ |

```
ä½¿ç”¨å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¡¬ç¼–ç è·¯å¾„ï¼ˆâŒï¼‰ï¼š   â”‚
â”‚ playSound("assets/  â”‚
â”‚   audio/jump.mp3"); â”‚
â”‚ â€¢ è·¯å¾„ç¡¬ç¼–ç         â”‚
â”‚ â€¢ éš¾ä»¥ç»´æŠ¤          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é€»è¾‘IDï¼ˆâœ…ï¼‰ï¼š       â”‚
â”‚ playSound("jump");  â”‚
â”‚ â€¢ ç®€æ´æ¸…æ™°          â”‚
â”‚ â€¢ æ˜“äºç»´æŠ¤          â”‚
â”‚ â€¢ æ”¯æŒé…ç½®          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç©ºé—´éŸ³é¢‘é¢„ç•™

```cpp
void playSound(const std::string& sound_id, int channel = -1, bool use_spatial = false);
```

**`playSound` å‡½æ•°è¿˜åŒ…å«ä¸€ä¸ª `use_spatial` å‚æ•°**ã€‚è™½ç„¶ SDL_mixer å¯¹3Dç©ºé—´éŸ³æ•ˆçš„æ”¯æŒæœ‰é™ï¼Œä½†æˆ‘ä»¬é¢„ç•™äº†è¿™ä¸ªæ¥å£ï¼Œå¹¶å®ç°äº†ä¸€ä¸ªç®€åŒ–ç‰ˆï¼šåªæœ‰å½“ç‰©ä½“ç¦»ç›¸æœºä¸­å¿ƒè¶³å¤Ÿè¿‘æ—¶æ‰æ’­æ”¾å£°éŸ³ã€‚

```
ç©ºé—´éŸ³é¢‘ç®€åŒ–å®ç°ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‰©ä½“åœ¨ç›¸æœºè§†é‡å†…ï¼š   â”‚
â”‚  ğŸ¥â”€â”€â”€â”€â”€â”€â”€â”€ğŸ‘¤        â”‚
â”‚  ç›¸æœº     ç©å®¶       â”‚
â”‚  è·ç¦» < é˜ˆå€¼         â”‚
â”‚  â†’ æ’­æ”¾éŸ³æ•ˆ âœ…       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç‰©ä½“åœ¨ç›¸æœºè§†é‡å¤–ï¼š   â”‚
â”‚  ğŸ¥              ğŸ‘¤  â”‚
â”‚  ç›¸æœº           ç©å®¶ â”‚
â”‚  è·ç¦» > é˜ˆå€¼         â”‚
â”‚  â†’ ä¸æ’­æ”¾ âŒ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸ºæœªæ¥æ‰©å±•æ›´é«˜çº§çš„
éŸ³é¢‘å¼•æ“æ‰“ä¸‹åŸºç¡€ï¼
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ•°æ®é©±åŠ¨çš„éŸ³æ•ˆé…ç½®

ä¸ºäº†å®ç°å½»åº•çš„æ•°æ®é©±åŠ¨ï¼Œæˆ‘ä»¬å°†éŸ³æ•ˆçš„é…ç½®å·¥ä½œä¹Ÿæ”¾åˆ°äº† Tiled åœ°å›¾ç¼–è¾‘å™¨ä¸­ã€‚

---

## 5. åœ¨Tiledä¸­é…ç½®éŸ³æ•ˆ

æˆ‘ä»¬çº¦å®šä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰å±æ€§ `"sound"`ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚

### é…ç½®ç¤ºä¾‹

ç¼–è¾‘å®Œæˆåï¼Œåœ¨ `actor.tsj` å›¾å—é›†æ–‡ä»¶ä¸­çš„éŸ³æ•ˆé…ç½®å¦‚ä¸‹ï¼š

```json
// åœ¨ç©å®¶ "Player" çš„è‡ªå®šä¹‰å±æ€§:
{
 "name":"sound",
 "type":"string",
 "value":"{\n  \"jump\":\"assets\\/audio\\/cartoon-jump-6462.mp3\",\n  \"hurt\":\"assets\\/audio\\/monster.mp3\",\n  \"dead\":\"assets\\/audio\\/dead-8bit-41400.mp3\"\n}"
}, 
// åœ¨é’è›™ "Frog" çš„è‡ªå®šä¹‰å±æ€§:
{
 "name":"sound",
 "type":"string",
 "value":"{\n  \"cry\":\"assets\\/audio\\/frog_quak-81741.mp3\"\n}"
}
```

### JSON æ ¼å¼è¯´æ˜

```
éŸ³æ•ˆJSONç»“æ„ï¼š
{
  "sound_id": "path/to/sound.mp3",
  ...
}

ç¤ºä¾‹ï¼š
{
  "jump": "assets/audio/jump.mp3",
  "hurt": "assets/audio/hurt.mp3",
  "dead": "assets/audio/dead.mp3"
}
```

### é…ç½®æµç¨‹

```
Tiledé…ç½®æµç¨‹ï¼š
    â†“
1. æ‰“å¼€ Tiled ç¼–è¾‘å™¨
    â†“
2. é€‰æ‹©å¯¹è±¡å›¾å—
    (ä¾‹å¦‚ï¼šPlayer)
    â†“
3. æ·»åŠ è‡ªå®šä¹‰å±æ€§
    name: "sound"
    type: "string"
    â†“
4. å¡«å†™JSONå€¼
    {"jump": "path/to/jump.mp3", ...}
    â†“
5. ä¿å­˜å›¾å—é›†
    actor.tsj
    â†“
æ¸¸æˆåŠ è½½æ—¶è‡ªåŠ¨è§£æ
```

---

## 6. LevelLoader è¯»å–éŸ³æ•ˆé…ç½®

æœ€åï¼Œæˆ‘ä»¬éœ€è¦è®© `LevelLoader` èƒ½è¯»æ‡‚è¿™äº›æ•°æ®ã€‚

### src/engine/scene/level_loader.cppï¼ˆæ›´æ–°ï¼‰

åœ¨ `loadObjectLayer` å‡½æ•°ä¸­ï¼Œå½“åŠ è½½ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦å­˜åœ¨ `"sound"` å±æ€§ï¼š

```cpp
// in src/engine/scene/level_loader.cpp çš„ loadObjectLayer å‡½æ•°ä¸­
// ...
auto sound_string = getTileProperty<std::string>(tile_json, "sound");
if (sound_string) {
    // è§£æstringä¸ºJSONå¯¹è±¡
    nlohmann::json sound_json;
    try {
        sound_json = nlohmann::json::parse(sound_string.value());
    } catch (const nlohmann::json::parse_error& e) {
        spdlog::error("è§£æéŸ³æ•ˆ JSON å­—ç¬¦ä¸²å¤±è´¥: {}", e.what());
        continue;
    }
    // æ·»åŠ AudioComponent
    auto* audio_component = game_object->addComponent<engine::component::AudioComponent>(
        &scene.getContext().getAudioPlayer(),
        &scene.getContext().getCamera()
    );
    // æ·»åŠ éŸ³æ•ˆåˆ° AudioComponent
    addSound(sound_json, audio_component);
}

// æ–°å¢ addSound è¾…åŠ©å‡½æ•°
void LevelLoader::addSound(const nlohmann::json &sound_json, engine::component::AudioComponent *audio_component)
{
    // éå†éŸ³æ•ˆ JSON å¯¹è±¡ä¸­çš„æ¯ä¸ªé”®å€¼å¯¹ï¼ˆéŸ³æ•ˆid : éŸ³æ•ˆè·¯å¾„ï¼‰
    for (const auto& sound : sound_json.items()) {
        const std::string& sound_id = sound.key();
        const std::string& sound_path = sound.value();
        // æ·»åŠ éŸ³æ•ˆåˆ° AudioComponent
        audio_component->addSound(sound_id, sound_path);
    }
}
```

### åŠ è½½æµç¨‹è¯¦è§£

```
éŸ³æ•ˆåŠ è½½æµç¨‹ï¼š
    â†“
1. LevelLoader åŠ è½½åœ°å›¾
    â†“
2. è¯»å–å¯¹è±¡å›¾å—
    â†“
3. æ£€æŸ¥ "sound" å±æ€§
    getTileProperty("sound")
    â†“
4. è§£æJSONå­—ç¬¦ä¸²
    nlohmann::json::parse()
    â†“
5. åˆ›å»º AudioComponent
    addComponent<AudioComponent>()
    â†“
6. éå†JSONé”®å€¼å¯¹
    for (sound : sound_json)
    â†“
7. æ·»åŠ éŸ³æ•ˆæ˜ å°„
    addSound(sound_id, sound_path)
    â†“
8. å®Œæˆï¼GameObject æ‹¥æœ‰éŸ³æ•ˆèƒ½åŠ›
```

### æ•°æ®é“¾è·¯

```
å®Œæ•´çš„æ•°æ®é“¾è·¯ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tiledç¼–è¾‘å™¨      â”‚ â† é…ç½®
â”‚ "sound" JSON     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ actor.tsj        â”‚ â† å­˜å‚¨
â”‚ å›¾å—é›†æ–‡ä»¶       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LevelLoader      â”‚ â† è§£æ
â”‚ è¯»å–å¹¶è§£æJSON   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioComponent   â”‚ â† ä½¿ç”¨
â”‚ å­˜å‚¨æ˜ å°„å…³ç³»     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ä»ç¼–è¾‘å™¨é…ç½®åˆ°æ¸¸æˆå†…ç»„ä»¶è‡ªåŠ¨åˆ›å»ºå’Œè®¾ç½®çš„å®Œæ•´æ•°æ®é“¾è·¯ï¼**

### ğŸ’¡ æ•°æ®é©±åŠ¨çš„ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **æ— éœ€ç¼–ç¨‹** | ç­–åˆ’å¯ç›´æ¥åœ¨Tiledä¸­é…ç½® |
| **å¿«é€Ÿè¿­ä»£** | ä¿®æ”¹é…ç½®ç«‹å³ç”Ÿæ•ˆ |
| **æ˜“äºç»´æŠ¤** | é›†ä¸­ç®¡ç†æ‰€æœ‰éŸ³æ•ˆé…ç½® |
| **æ”¯æŒçƒ­æ›´æ–°** | å¯ä»¥åœ¨è¿è¡Œæ—¶é‡æ–°åŠ è½½ |

---

## ç¬¬å››éƒ¨åˆ†ï¼šåœ¨æ¸¸æˆä¸­å‘å£°ï¼

ä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä¸œé£ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦åœ¨æ¸¸æˆé€»è¾‘çš„å„ä¸ªè§’è½é‡Œï¼Œè§¦å‘å£°éŸ³çš„æ’­æ”¾ã€‚

---

## 7. èƒŒæ™¯éŸ³ä¹ä¸å…¨å±€éŸ³é‡

åœ¨ `GameScene::init` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨èƒŒæ™¯éŸ³ä¹å¹¶è®¾ç½®ä¸€ä¸ªèˆ’é€‚çš„éŸ³é‡ã€‚

### src/game/scene/game_scene.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/scene/game_scene.cpp
void GameScene::init() {
    // ...
    // è®¾ç½®éŸ³é‡
    context_.getAudioPlayer().setMusicVolume(0.2f);  // è®¾ç½®èƒŒæ™¯éŸ³ä¹éŸ³é‡ä¸º20%
    context_.getAudioPlayer().setSoundVolume(0.5f);  // è®¾ç½®éŸ³æ•ˆéŸ³é‡ä¸º50%
    // æ’­æ”¾èƒŒæ™¯éŸ³ä¹ (å¾ªç¯ï¼Œæ·¡å…¥1ç§’)
    context_.getAudioPlayer().playMusic("assets/audio/hurry_up_and_run.ogg", -1, 1000);

    Scene::init();
    spdlog::trace("GameScene åˆå§‹åŒ–å®Œæˆã€‚");
}
```

### éŸ³é‡è®¾ç½®è¯´æ˜

| è®¾ç½® | å€¼ | è¯´æ˜ |
|------|-----|------|
| **èƒŒæ™¯éŸ³ä¹** | 0.2 (20%) | ä¸ä¼šç›–è¿‡éŸ³æ•ˆ |
| **éŸ³æ•ˆ** | 0.5 (50%) | æ¸…æ™°å¯é—» |

### æ’­æ”¾å‚æ•°è¯´æ˜

```cpp
playMusic("path/to/music.ogg", -1, 1000);
         // â†‘                  â†‘    â†‘
         // éŸ³ä¹è·¯å¾„           å¾ªç¯  æ·¡å…¥æ—¶é—´
```

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| **loops** | -1 | æ— é™å¾ªç¯ |
| **fade_in_ms** | 1000 | 1ç§’æ·¡å…¥æ•ˆæœ |

---

## 8. ç©å®¶çŠ¶æ€éŸ³æ•ˆ

ç©å®¶çš„è¡Œä¸ºæ˜¯æœ€éœ€è¦éŸ³æ•ˆåé¦ˆçš„åœ°æ–¹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å„ä¸ªçŠ¶æ€çš„ `enter` æ–¹æ³•ä¸­æ’­æ”¾å¯¹åº”çš„å£°éŸ³ã€‚

### ç¬¬ä¸€æ­¥ï¼šPlayerComponent ç¼“å­˜ AudioComponent

é¦–å…ˆï¼Œè®© `PlayerComponent` è·å–å¹¶ç¼“å­˜ `AudioComponent`ã€‚

#### src/game/component/player_component.hï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/component/player_component.h
class PlayerComponent final : public engine::component::Component {
    // ...
    engine::component::HealthComponent* health_component_ = nullptr;
    engine::component::AudioComponent* audio_component_ = nullptr;
    // ...
public:
    // ...
    engine::component::AudioComponent* getAudioComponent() const { return audio_component_; }
};
```

### ç¬¬äºŒæ­¥ï¼šåœ¨å„çŠ¶æ€ä¸­æ’­æ”¾éŸ³æ•ˆ

#### JumpState - è·³è·ƒéŸ³æ•ˆ

##### src/game/component/state/jump_state.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/component/state/jump_state.cpp
void JumpState::enter() {
    // ...
    physics_component->velocity_.y = -player_component_->getJumpVelocity();
    
    if (auto* audio_component = player_component_->getAudioComponent(); audio_component) {
        audio_component->playSound("jump");  // æ’­æ”¾è·³è·ƒéŸ³æ•ˆ
    }
    spdlog::debug("PlayerComponent è¿›å…¥ JumpState...");
}
```

#### HurtState - å—ä¼¤éŸ³æ•ˆ

##### src/game/component/state/hurt_state.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/component/state/hurt_state.cpp
void HurtState::enter() {
    // ...
    if (auto* audio_component = player_component_->getAudioComponent(); audio_component) {
        audio_component->playSound("hurt");  // æ’­æ”¾å—ä¼¤éŸ³æ•ˆ
    }
}
```

#### DeadState - æ­»äº¡éŸ³æ•ˆ

##### src/game/component/state/dead_state.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/component/state/dead_state.cpp
void DeadState::enter() {
    // ...
    if (auto* audio_component = player_component_->getAudioComponent(); audio_component) {
        audio_component->playSound("dead");  // æ’­æ”¾æ­»äº¡éŸ³æ•ˆ
    }
}
```

### ç©å®¶éŸ³æ•ˆæ€»è§ˆ

```
ç©å®¶éŸ³æ•ˆè§¦å‘ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JumpState::enter()   â”‚
â”‚ â†’ playSound("jump")  â”‚ ğŸµ è·³è·ƒå£°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HurtState::enter()   â”‚
â”‚ â†’ playSound("hurt")  â”‚ ğŸµ å—ä¼¤å£°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DeadState::enter()   â”‚
â”‚ â†’ playSound("dead")  â”‚ ğŸµ æ­»äº¡å£°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| çŠ¶æ€ | éŸ³æ•ˆID | è§¦å‘æ—¶æœº |
|------|--------|---------|
| **JumpState** | "jump" | è¿›å…¥çŠ¶æ€æ—¶ |
| **HurtState** | "hurt" | è¿›å…¥çŠ¶æ€æ—¶ |
| **DeadState** | "dead" | è¿›å…¥çŠ¶æ€æ—¶ |

---

## 9. æ•ŒäººAIéŸ³æ•ˆ

åŒæ ·åœ°ï¼Œæˆ‘ä»¬è®© `AIComponent` ä¹Ÿèƒ½è·å– `AudioComponent`ã€‚ç„¶ååœ¨ `JumpBehavior` ä¸­ï¼Œå½“æ•Œäººè½åœ°æ—¶ï¼Œæ’­æ”¾å®ƒçš„å«å£°ã€‚

### src/game/component/ai/jump_behavior.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/component/ai/jump_behavior.cpp
void JumpBehavior::update(float delta_time, AIComponent& ai_component) {
    // ...
    auto* audio_component = ai_component.getAudioComponent();
    // ...
    auto is_on_ground = physics_component->hasCollidedBelow();
    if (is_on_ground) {
        if (audio_component && jump_timer_ < 0.001f) { // åˆšåˆšè½åœ°æ—¶
            audio_component->playSound("cry", -1, true); // ä½¿ç”¨ç©ºé—´éŸ³é¢‘
        }
        // ...
    }
}
```

### æ•ŒäººéŸ³æ•ˆç‰¹ç‚¹

```
æ•ŒäººéŸ³æ•ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é’è›™è½åœ°æ—¶ï¼š         â”‚
â”‚  ğŸ¸ â†“ è½åœ°           â”‚
â”‚  jump_timer_ < 0.001 â”‚
â”‚  â†’ playSound("cry",  â”‚
â”‚      -1, true)       â”‚
â”‚     â†‘         â†‘      â”‚
â”‚  è‡ªåŠ¨é€šé“  ç©ºé—´éŸ³é¢‘  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| **sound_id** | "cry" | å«å£°éŸ³æ•ˆ |
| **channel** | -1 | è‡ªåŠ¨é€‰æ‹©é€šé“ |
| **use_spatial** | true | ä½¿ç”¨ç©ºé—´éŸ³é¢‘ |

**ä½¿ç”¨ç©ºé—´éŸ³é¢‘**ï¼šåªæœ‰å½“æ•Œäººåœ¨ç›¸æœºè§†é‡é™„è¿‘æ—¶æ‰æ’­æ”¾å£°éŸ³ï¼Œé¿å…è¿‡å¤šéŸ³æ•ˆæ··æ‚ã€‚

---

## 10. åœºæ™¯äº‹ä»¶éŸ³æ•ˆ

æœ‰äº›éŸ³æ•ˆä¸å±äºä»»ä½•ç‰¹å®šå¯¹è±¡ï¼Œè€Œæ˜¯ç”±åœºæ™¯ä¸­çš„äº‹ä»¶è§¦å‘ï¼Œæ¯”å¦‚åƒåˆ°é“å…·ã€è¸©æ­»æ•Œäººã€‚è¿™ç±»éŸ³æ•ˆå¯ä»¥ç›´æ¥é€šè¿‡ `Context` æ¥æ’­æ”¾ã€‚

### åœ¨ GameScene çš„ç¢°æ’å¤„ç†å‡½æ•°ä¸­

#### src/game/scene/game_scene.cppï¼ˆæ›´æ–°ï¼‰

```cpp
// in src/game/scene/game_scene.cpp
// ç©å®¶è¸©åˆ°æ•Œäºº
void GameScene::PlayerVSEnemyCollision(...) {
    // ...
    if (is_stomp) {
        // ...
        player->getComponent<engine::component::PhysicsComponent>()->velocity_.y = -300.0f;
        context_.getAudioPlayer().playSound("assets/audio/punch2a.mp3");
    }
    // ...
}

// ç©å®¶åƒåˆ°é“å…·
void GameScene::PlayerVSItemCollision(...) {
    // ...
    item->setNeedRemove(true);
    createEffect(item_aabb.position + item_aabb.size / 2.0f, item->getTag());
    context_.getAudioPlayer().playSound("assets/audio/poka01.mp3");
}
```

### ä¸¤ç§æ’­æ”¾æ–¹å¼

**æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä¼ å…¥äº†æ–‡ä»¶è·¯å¾„ï¼Œå±•ç¤ºäº† AudioPlayer çµæ´»çš„ä¸¤ç§ç”¨æ³•**ï¼š

```
AudioPlayer çš„ä¸¤ç§ç”¨æ³•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–¹å¼1ï¼šé€šè¿‡ç»„ä»¶      â”‚
â”‚ audio_component->    â”‚
â”‚   playSound("jump"); â”‚
â”‚ â†‘                    â”‚
â”‚ é€»è¾‘IDï¼Œéœ€é¢„å…ˆé…ç½®   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–¹å¼2ï¼šç›´æ¥æ’­æ”¾      â”‚
â”‚ audio_player.        â”‚
â”‚   playSound(         â”‚
â”‚   "assets/audio/     â”‚
â”‚    jump.mp3");       â”‚
â”‚ â†‘                    â”‚
â”‚ å®Œæ•´è·¯å¾„ï¼Œå³ç”¨å³æ’­   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| æ–¹å¼ | ä½¿ç”¨åœºæ™¯ | ä¼˜åŠ¿ |
|------|---------|------|
| **é€šè¿‡ç»„ä»¶** | å¯¹è±¡ä¸“å±éŸ³æ•ˆ | é…ç½®çµæ´»ï¼Œæ˜“äºç®¡ç† |
| **ç›´æ¥æ’­æ”¾** | åœºæ™¯äº‹ä»¶éŸ³æ•ˆ | ç®€å•ç›´æ¥ï¼Œæ— éœ€é…ç½® |

### åœºæ™¯äº‹ä»¶éŸ³æ•ˆæ€»è§ˆ

```
åœºæ™¯äº‹ä»¶éŸ³æ•ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¸©è¸æ•Œäººï¼š           â”‚
â”‚  ğŸ‘¤ è¸© ğŸ¸            â”‚
â”‚  â†’ punch2a.mp3       â”‚ ğŸµ å‡»æ‰“éŸ³
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ”¶é›†é“å…·ï¼š           â”‚
â”‚  ğŸ‘¤ + ğŸ’            â”‚
â”‚  â†’ poka01.mp3        â”‚ ğŸµ æ‹¾å–éŸ³
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… ç¼–è¯‘ä¸è¿è¡Œ

ç¼–è¯‘å¹¶è¿è¡Œæ¸¸æˆï¼Œä½ ä¼šå¬åˆ°ä¸€ä¸ªæœ‰å£°æœ‰è‰²çš„æ¸¸æˆä¸–ç•Œï¼š

```
è¿è¡Œæ•ˆæœï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  èƒŒæ™¯éŸ³ä¹ï¼š              â”‚
â”‚  ğŸµ hurry_up_and_run.oggâ”‚
â”‚  å¾ªç¯æ’­æ”¾ï¼Œæ·¡å…¥æ•ˆæœ     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç©å®¶éŸ³æ•ˆï¼š              â”‚
â”‚  ğŸµ è·³è·ƒå£°               â”‚
â”‚  ğŸµ å—ä¼¤å£°               â”‚
â”‚  ğŸµ æ­»äº¡å£°               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•ŒäººéŸ³æ•ˆï¼š              â”‚
â”‚  ğŸµ é’è›™å«å£°ï¼ˆè½åœ°æ—¶ï¼‰   â”‚
â”‚  ç©ºé—´éŸ³é¢‘æ•ˆæœ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  äº‹ä»¶éŸ³æ•ˆï¼š              â”‚
â”‚  ğŸµ è¸©è¸æ•Œäºº             â”‚
â”‚  ğŸµ æ”¶é›†é“å…·             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä½ ä¼šå¬åˆ°ï¼š**
- âœ… èƒŒæ™¯éŸ³ä¹å¾ªç¯æ’­æ”¾ï¼Œè¥é€ æ°›å›´
- âœ… ç©å®¶è·³è·ƒæ—¶å‘å‡ºæ¸…è„†çš„éŸ³æ•ˆ
- âœ… å—ä¼¤æ—¶æœ‰æ˜æ˜¾çš„åé¦ˆå£°éŸ³
- âœ… é’è›™è½åœ°æ—¶å‘å‡ºå«å£°
- âœ… è¸©è¸æ•Œäººå’Œæ”¶é›†é“å…·éƒ½æœ‰åé¦ˆ
- âœ… æ‰€æœ‰éŸ³æ•ˆéŸ³é‡å¹³è¡¡åˆç†
- âœ… æ¸¸æˆä¸–ç•Œç¬é—´ç”ŸåŠ¨æ´»æ³¼èµ·æ¥ï¼

---

## ğŸ¯ ç³»ç»Ÿæ¶æ„æ€»ç»“

### å®Œæ•´çš„éŸ³é¢‘ç³»ç»Ÿæ¶æ„

```
éŸ³é¢‘ç³»ç»Ÿå±‚æ¬¡ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SDL_mixer           â”‚ â† åº•å±‚åº“
â”‚   (Cé£æ ¼éŸ³é¢‘API)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ å°è£…
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ResourceManager       â”‚ â† èµ„æºå±‚
â”‚   (åŠ è½½å’Œç¼“å­˜éŸ³é¢‘)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ æä¾›èµ„æº
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     AudioPlayer          â”‚ â† å¼•æ“å±‚
â”‚   (ç»Ÿä¸€æ’­æ”¾æ¥å£)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚         â”‚
    â†“         â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Audio   â”‚â”‚Context â”‚â”‚Level   â”‚ â† ä½¿ç”¨å±‚
â”‚Comp    â”‚â”‚ç›´æ¥è°ƒç”¨â”‚â”‚Loader  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæˆå°±

æˆ‘ä»¬æˆåŠŸåœ°ï¼š

1. âœ… **æ„å»ºäº†å¼•æ“å±‚éŸ³é¢‘æ¨¡å—**ï¼šAudioPlayer å°è£… SDL_mixer
2. âœ… **åˆ›å»ºäº†éŸ³é¢‘ç»„ä»¶**ï¼šAudioComponent ç®¡ç†å¯¹è±¡éŸ³æ•ˆ
3. âœ… **å®ç°äº†æ•°æ®é©±åŠ¨**ï¼šTiled é…ç½®éŸ³æ•ˆï¼Œè‡ªåŠ¨åŠ è½½
4. âœ… **é›†æˆåˆ°æ¸¸æˆå„å¤„**ï¼šç©å®¶ã€æ•Œäººã€äº‹ä»¶éƒ½æœ‰éŸ³æ•ˆ
5. âœ… **å®ç°äº†é€»è¾‘è§£è€¦**ï¼šéŸ³æ•ˆIDä¸æ–‡ä»¶è·¯å¾„åˆ†ç¦»
6. âœ… **æ”¯æŒç©ºé—´éŸ³é¢‘**ï¼šç®€åŒ–ç‰ˆçš„è·ç¦»è¡°å‡

### éŸ³é¢‘ç³»ç»Ÿç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ | ä¼˜åŠ¿ |
|------|------|------|
| **åˆ†å±‚è®¾è®¡** | å¼•æ“å±‚ + ç»„ä»¶å±‚ | æ¸…æ™°çš„èŒè´£åˆ’åˆ† |
| **æ•°æ®é©±åŠ¨** | Tiled é…ç½® | æ— éœ€ä¿®æ”¹ä»£ç  |
| **é€»è¾‘è§£è€¦** | ID â†’ è·¯å¾„æ˜ å°„ | æ˜“äºç»´æŠ¤å’Œæ›¿æ¢ |
| **åŒé‡æ¥å£** | ç»„ä»¶ + ç›´æ¥æ’­æ”¾ | çµæ´»é€‚åº”ä¸åŒåœºæ™¯ |
| **å•ä¸€èŒè´£** | AudioPlayer ä¸“æ³¨æ’­æ”¾ | é«˜å†…èšä½è€¦åˆ |

### èŒè´£åˆ’åˆ†

```
æ¸…æ™°çš„èŒè´£åˆ†å·¥ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ResourceManager  â”‚ â† èµ„æºç®¡ç†è€…
â”‚ "åŠ è½½éŸ³é¢‘æ–‡ä»¶"    â”‚   åŠ è½½å’Œç¼“å­˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioPlayer      â”‚ â† æ’­æ”¾æ§åˆ¶è€…
â”‚ "æ§åˆ¶éŸ³é¢‘æ’­æ”¾"    â”‚   æ’­æ”¾å’ŒéŸ³é‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AudioComponent   â”‚ â† é€»è¾‘å°è£…è€…
â”‚ "ç®¡ç†å¯¹è±¡éŸ³æ•ˆ"    â”‚   IDæ˜ å°„å’Œç©ºé—´éŸ³é¢‘
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PlayerState/     â”‚ â† ä¸šåŠ¡ä½¿ç”¨è€…
â”‚ GameScene        â”‚   è§¦å‘éŸ³æ•ˆæ’­æ”¾
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éŸ³æ•ˆé…ç½®æµç¨‹

```
ä»é…ç½®åˆ°æ’­æ”¾ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Tiledé…ç½®     â”‚
â”‚ "sound" JSON     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. LevelLoader   â”‚
â”‚ è§£æå¹¶åˆ›å»ºç»„ä»¶   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. AudioComponentâ”‚
â”‚ å­˜å‚¨IDæ˜ å°„       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. PlayerState   â”‚
â”‚ playSound("jump")â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. AudioPlayer   â”‚
â”‚ æ’­æ”¾å®é™…éŸ³æ•ˆ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸¤ç§æ’­æ”¾æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | ä»£ç  | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|------|---------|
| **ç»„ä»¶æ–¹å¼** | `audio_comp->playSound("jump")` | é…ç½®çµæ´»ã€æ˜“ç®¡ç† | éœ€é¢„å…ˆé…ç½® | å¯¹è±¡ä¸“å±éŸ³æ•ˆ |
| **ç›´æ¥æ–¹å¼** | `audio_player.playSound(path)` | ç®€å•ç›´æ¥ | è·¯å¾„ç¡¬ç¼–ç  | ä¸€æ¬¡æ€§äº‹ä»¶éŸ³æ•ˆ |

---

## ğŸ“š æ€»ç»“

æ­å–œä½ ï¼é€šè¿‡æœ¬èŠ‚è¯¾çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æˆåŠŸåœ°ä¸º"é˜³å…‰å²›"æ„å»ºäº†ä¸€å¥—åŠŸèƒ½å®Œå–„ã€è®¾è®¡ä¼˜é›…çš„éŸ³é¢‘ç³»ç»Ÿã€‚**ç°åœ¨è¿è¡Œæ¸¸æˆï¼Œä½ ä¼šå‘ç°ä¸–ç•Œç¬é—´å˜å¾—ç”ŸåŠ¨æ´»æ³¼èµ·æ¥ï¼**

**å…³é”®è¦ç‚¹ï¼š**
- ğŸµ AudioPlayerï¼šå°è£… SDL_mixer çš„ç»Ÿä¸€æ’­æ”¾æ¥å£
- ğŸ”Š AudioComponentï¼šå¯¹è±¡ä¸“å±çš„éŸ³æ•ˆç®¡ç†
- ğŸ“ æ•°æ®é©±åŠ¨ï¼šTiled é…ç½®éŸ³æ•ˆï¼Œè‡ªåŠ¨åŠ è½½
- ğŸ¼ é€»è¾‘è§£è€¦ï¼šéŸ³æ•ˆIDä¸æ–‡ä»¶è·¯å¾„åˆ†ç¦»
- ğŸšï¸ éŸ³é‡æ§åˆ¶ï¼šèƒŒæ™¯éŸ³ä¹å’ŒéŸ³æ•ˆç‹¬ç«‹è°ƒèŠ‚
- ğŸŒ ç©ºé—´éŸ³é¢‘ï¼šç®€åŒ–ç‰ˆçš„è·ç¦»åˆ¤æ–­
- ğŸ”„ åŒé‡æ¥å£ï¼šç»„ä»¶æ’­æ”¾ + ç›´æ¥æ’­æ”¾

> ğŸ’¡ **è®¾è®¡å“²å­¦**ï¼šæˆ‘ä»¬å›é¡¾ä¸€ä¸‹æœ¬è¯¾çš„æˆæœâ€”â€”å¼•æ“å±‚ï¼šæˆ‘ä»¬æ‹¥æœ‰äº†å¯å¤ç”¨çš„ AudioPlayer å’Œ AudioComponentã€‚æ•°æ®é©±åŠ¨ï¼šæˆ‘ä»¬å¯ä»¥åœ¨ Tiled ä¸­ä¸ºä»»ä½•å¯¹è±¡é…ç½®å®ƒè‡ªå·±çš„å£°éŸ³ï¼Œæ— éœ€ä¿®æ”¹ä¸€è¡Œä»£ç ã€‚æ¸¸æˆå±‚ï¼šæˆ‘ä»¬å°†éŸ³æ•ˆä¸ç©å®¶çŠ¶æ€ã€æ•ŒäººAIå’Œåœºæ™¯äº‹ä»¶ç´§å¯†ç»“åˆï¼Œæä¾›äº†ä¸°å¯Œçš„å¬è§‰åé¦ˆã€‚è¿™å¥—ç³»ç»Ÿä¸ä»…è®©æˆ‘ä»¬çš„æ¸¸æˆä½“éªŒå¤§å¹…æå‡ï¼Œä¹Ÿå†æ¬¡å°è¯äº†åˆ†å±‚æ¶æ„å’Œç»„ä»¶åŒ–è®¾è®¡çš„å¼ºå¤§å¨åŠ›ã€‚

**éŸ³é¢‘ç³»ç»Ÿçš„ä»·å€¼**ï¼š

```
è§†è§‰ + å¬è§‰ = å®Œæ•´ä½“éªŒï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åªæœ‰è§†è§‰ï¼ˆ50åˆ†ï¼‰ï¼š   â”‚
â”‚ â€¢ ç”»é¢ç²¾ç¾          â”‚
â”‚ â€¢ åŠ¨ç”»æµç•…          â”‚
â”‚ â†’ æ€»æ„Ÿè§‰ç¼ºç‚¹ä»€ä¹ˆ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è§†è§‰ + å¬è§‰ï¼ˆ100åˆ†ï¼‰ï¼šâ”‚
â”‚ + éŸ³æ•ˆåé¦ˆ          â”‚
â”‚ + èƒŒæ™¯éŸ³ä¹          â”‚
â”‚ + æ°›å›´è¥é€           â”‚
â”‚ â†’ æ²‰æµ¸æ„Ÿçˆ†æ£šï¼     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

éŸ³æ•ˆæ˜¯æ¸¸æˆçµé­‚çš„ä¸€éƒ¨åˆ†ï¼
```

---

## ğŸš€ ä¸‹ä¸€æ­¥å±•æœ›

ç°åœ¨ï¼Œæˆ‘ä»¬çš„"é˜³å…‰å²›"å·²ç»æœ‰äº†å®Œæ•´çš„è§†è§‰ã€äº¤äº’å’Œå¬è§‰ç³»ç»Ÿã€‚ä½†æ¸¸æˆåªæœ‰ä¸€ä¸ªå…³å¡ï¼Œç©å®¶æ— æ³•ä½“éªŒåˆ°æ›´å¤šå†…å®¹ã€‚

- â“ å¦‚ä½•è®¾è®¡å¤šä¸ªå…³å¡ï¼Ÿ
- â“ å¦‚ä½•åœ¨å…³å¡ä¹‹é—´åˆ‡æ¢ï¼Ÿ
- â“ å¦‚ä½•åœ¨å…³å¡é—´å…±äº«æ¸¸æˆæ•°æ®ï¼Ÿ

ä¸‹ä¸€è¯¾ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ‰©å±•æ¸¸æˆä¸–ç•Œï¼š

- ğŸ—ºï¸ **å…³å¡åˆ‡æ¢**ï¼šå®ç°å¤šå…³å¡ç³»ç»Ÿ
- ğŸšª **ä¼ é€é—¨æœºåˆ¶**ï¼šå…³å¡é—´çš„è¿‡æ¸¡
- ğŸ’¾ **å…±äº«æ¸¸æˆæ•°æ®**ï¼šç©å®¶çŠ¶æ€çš„ä¿æŒ
- ğŸ® **æ›´ä¸°å¯Œçš„æ¸¸æˆå†…å®¹**ï¼šæ„å»ºå®Œæ•´çš„æ¸¸æˆæµç¨‹

ä¿æŒæ¢ç´¢çš„çƒ­æƒ…ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼ğŸ®ğŸŒŸ