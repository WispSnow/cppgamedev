# å˜æ¢ä¸ç²¾çµç»„ä»¶

<div class="video-container">
  <div id="bilibili" class="video-content">
    <!-- Bç«™åµŒå…¥ï¼šä½¿ç”¨ https æ˜ç¡®åè®®ï¼ˆé¿å… file:// æˆ– http å¯¼è‡´è¢«æµè§ˆå™¨æ‹¦æˆªï¼‰ -->
    <iframe
      class="video-frame"
      src="https://player.bilibili.com/player.html?bvid=BV1WY33zSE2a&page=1&autoplay=0&danmaku=0&high_quality=1"
      width="100%"
      height="480"
      scrolling="no"
      frameborder="0"
      allowfullscreen>
    </iframe>
  </div>
</div>

[åœ¨ Bilibili ä¸Šè§‚çœ‹](https://www.bilibili.com/video/BV1WY33zSE2a)

## ğŸ“Œ é—®é¢˜èƒŒæ™¯

åœ¨ä¸Šä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†å¼ºå¤§çš„ `GameObject` å’Œ `Component` åŸºç±»ï¼Œä¸ºæˆ‘ä»¬çš„å¼•æ“å¥ å®šäº†é¢å‘ç»„ä»¶ç¼–ç¨‹çš„åŸºçŸ³ã€‚ç„¶è€Œï¼Œè¿™äº›è¿˜åªæ˜¯è“å›¾ã€‚`GameObject` æœ¬èº«æ˜¯çœ‹ä¸è§æ‘¸ä¸ç€çš„ï¼Œ`Component` åŸºç±»ä¹Ÿæœªå®ç°ä»»ä½•å…·ä½“åŠŸèƒ½ã€‚

æœ¬èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ª **æœ€æ ¸å¿ƒçš„ç»„ä»¶**ï¼Œèµ‹äºˆæ¸¸æˆå¯¹è±¡åœ¨ä¸–ç•Œä¸­å­˜åœ¨çš„åŸºç¡€å±æ€§ï¼š

### ğŸ¯ æœ¬è¯¾ç›®æ ‡

| ç»„ä»¶ | æ ¸å¿ƒé—®é¢˜ | èŒè´£ |
|------|----------|------|
| **TransformComponent** | å®ƒåœ¨å“ªå„¿ï¼Ÿ | è´Ÿè´£å­˜å‚¨æ¸¸æˆå¯¹è±¡çš„ä½ç½®ï¼ˆpositionï¼‰ã€æ—‹è½¬ï¼ˆrotationï¼‰å’Œç¼©æ”¾ï¼ˆscaleï¼‰ã€‚è¿™æ˜¯å‡ ä¹æ‰€æœ‰æ¸¸æˆå¯¹è±¡éƒ½å¿…å¤‡çš„ç»„ä»¶ |
| **SpriteComponent** | å®ƒé•¿ä»€ä¹ˆæ ·ï¼Ÿ | è´Ÿè´£åœ¨æ¸¸æˆå¯¹è±¡çš„ä½ç½®ä¸Šç»˜åˆ¶ä¸€ä¸ªç²¾çµï¼ˆspriteï¼‰ï¼Œè®©æˆ‘ä»¬çš„å¯¹è±¡å˜å¾—å¯è§ |

### ğŸ¤” æ¶æ„æŒ‘æˆ˜

ä½†åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ¶æ„ä¸Šçš„æŒ‘æˆ˜ï¼š

> â“ **ç»„ä»¶å¦‚ä½•ä¸å¼•æ“çš„å…¶ä»–éƒ¨åˆ†ï¼ˆå¦‚ Rendererã€ResourceManagerï¼‰é€šä¿¡ï¼Ÿ**

---

## 1. ä¾èµ–æ³¨å…¥ä¸ Context ç±»

### é—®é¢˜åˆ†æ

`SpriteComponent` éœ€è¦ï¼š
- è°ƒç”¨ `Renderer` æ¥ç»˜åˆ¶è‡ªå·±
- è®¿é—® `ResourceManager` æ¥è·å–çº¹ç†ä¿¡æ¯

æˆ‘ä»¬å½“ç„¶å¯ä»¥åœ¨åˆ›å»º `SpriteComponent` æ—¶æŠŠ `Renderer` å’Œ `ResourceManager` çš„æŒ‡é’ˆä¼ ç»™å®ƒï¼Œä½†ï¼š

âŒ **ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š**
```cpp
// æ„é€ å‡½æ•°è¶Šæ¥è¶Šé•¿
SpriteComponent(Renderer* r, ResourceManager* rm, Camera* cam, AudioManager* am, ...);
```

éšç€ç»„ä»¶å’Œå¼•æ“æ¨¡å—è¶Šæ¥è¶Šå¤šï¼š
- æ„é€ å‡½æ•°ä¼šå˜å¾—è¶Šæ¥è¶Šé•¿
- ä¾èµ–å…³ç³»ä¼šå˜å¾—é”™ç»¼å¤æ‚
- ä¿®æ”¹å’Œç»´æŠ¤å›°éš¾

### ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šContextï¼ˆä¸Šä¸‹æ–‡ï¼‰ç±»

<img src="https://theorhythm.top/gamedev/SL/SL.042.webp" alt="å˜æ¢ä¸ç²¾çµ" style="display: block; margin: auto; width: 700px;" />

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ç§ä¼˜é›…çš„è®¾è®¡æ¨¡å¼ï¼š**ä¾èµ–æ³¨å…¥å®¹å™¨**ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç§°ä¹‹ä¸º `Context`ï¼ˆä¸Šä¸‹æ–‡ï¼‰ç±»ã€‚

#### engine/core/context.h

```cpp
#pragma once
// å‰ç½®å£°æ˜æ ¸å¿ƒç³»ç»Ÿ
namespace engine::input {
    class InputManager;
}

namespace engine::render {
    class Renderer;
    class Camera;
}

namespace engine::resource {
    class ResourceManager;
}

namespace engine::core {

/**
 * @brief æŒæœ‰å¯¹æ ¸å¿ƒå¼•æ“æ¨¡å—å¼•ç”¨çš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚
 *
 * ç”¨äºç®€åŒ–ä¾èµ–æ³¨å…¥ï¼Œä¼ é€’Contextå³å¯è·å–å¼•æ“çš„å„ä¸ªæ¨¡å—ã€‚
 */
class Context final {
private:
    // ä½¿ç”¨å¼•ç”¨ï¼Œç¡®ä¿æ¯ä¸ªæ¨¡å—éƒ½æœ‰æ•ˆï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦ä¸ºç©ºã€‚
    engine::input::InputManager& input_manager_;            ///< @brief è¾“å…¥ç®¡ç†å™¨
    engine::render::Renderer& renderer_;                    ///< @brief æ¸²æŸ“å™¨
    engine::render::Camera& camera_;                        ///< @brief ç›¸æœº
    engine::resource::ResourceManager& resource_manager_;   ///< @brief èµ„æºç®¡ç†å™¨

public:
    /**
     * @brief æ„é€ å‡½æ•°ã€‚
     * @param input_manager å¯¹ InputManager å®ä¾‹çš„å¼•ç”¨ã€‚
     * @param renderer å¯¹ Renderer å®ä¾‹çš„å¼•ç”¨ã€‚
     * @param camera å¯¹ Camera å®ä¾‹çš„å¼•ç”¨ã€‚
     * @param resource_manager å¯¹ ResourceManager å®ä¾‹çš„å¼•ç”¨ã€‚
     */
    Context(engine::input::InputManager& input_manager,
            engine::render::Renderer& renderer,
            engine::render::Camera& camera,
            engine::resource::ResourceManager& resource_manager);

    // ç¦æ­¢æ‹·è´å’Œç§»åŠ¨ï¼ŒContext å¯¹è±¡é€šå¸¸æ˜¯å”¯ä¸€çš„æˆ–æŒ‰éœ€åˆ›å»º/ä¼ é€’
    Context(const Context&) = delete;
    Context& operator=(const Context&) = delete;
    Context(Context&&) = delete;
    Context& operator=(Context&&) = delete;

    // --- Getters ---
    engine::input::InputManager& getInputManager() const { return input_manager_; }             ///< @brief è·å–è¾“å…¥ç®¡ç†å™¨
    engine::render::Renderer& getRenderer() const { return renderer_; }                         ///< @brief è·å–æ¸²æŸ“å™¨
    engine::render::Camera& getCamera() const { return camera_; }                               ///< @brief è·å–ç›¸æœº
    engine::resource::ResourceManager& getResourceManager() const { return resource_manager_; } ///< @brief è·å–èµ„æºç®¡ç†å™¨

};

} // namespace engine::core
```

#### engine/core/context.cpp
```cpp
#include "context.h"
#include "../input/input_manager.h"
#include "../render/renderer.h"
#include "../render/camera.h"
#include "../resource/resource_manager.h"
#include <spdlog/spdlog.h>

namespace engine::core {

Context::Context(engine::input::InputManager& input_manager, 
                 engine::render::Renderer& renderer,
                 engine::render::Camera& camera,
                 engine::resource::ResourceManager& resource_manager) // æ·»åŠ  game_state å‚æ•°
    : input_manager_(input_manager),
      renderer_(renderer),
      camera_(camera),
      resource_manager_(resource_manager) // åˆå§‹åŒ– game_state_ æˆå‘˜
{
    spdlog::trace("ä¸Šä¸‹æ–‡å·²åˆ›å»ºå¹¶åˆå§‹åŒ–ï¼ŒåŒ…å«è¾“å…¥ç®¡ç†å™¨ã€æ¸²æŸ“å™¨ã€ç›¸æœºå’Œèµ„æºç®¡ç†å™¨ã€‚");
}

} // namespace engine::core 
```

### ğŸ”‘ Context çš„ä½œç”¨

å®ƒçš„ä½œç”¨å°±åƒä¸€ä¸ª **"å·¥å…·ç®±"**ï¼š

```
ä»»ä½•éœ€è¦ä½¿ç”¨å¼•æ“åŠŸèƒ½çš„éƒ¨åˆ†ï¼ˆæ¯”å¦‚æˆ‘ä»¬çš„ç»„ä»¶ï¼‰
    â†“
ä¸å†éœ€è¦å…³å¿ƒå¦‚ä½•è·å– Renderer æˆ– InputManager
    â†“
åªéœ€è·å–è¿™ä¸€ä¸ª Context å¯¹è±¡
    â†“
å°±å¯ä»¥é€šè¿‡å®ƒè®¿é—®æ‰€æœ‰éœ€è¦çš„å·¥å…·
```

**ä¼˜åŠ¿ï¼š**
- âœ… **å•ä¸€æ³¨å…¥ç‚¹**ï¼šåªéœ€è¦ä¼ é€’ä¸€ä¸ª Context å¯¹è±¡
- âœ… **æ¾è€¦åˆ**ï¼šç»„ä»¶ä¸ç›´æ¥ä¾èµ–å…·ä½“çš„ç®¡ç†å™¨
- âœ… **æ˜“äºæ‰©å±•**ï¼šæ–°å¢æ¨¡å—åªéœ€ä¿®æ”¹ Context
- âœ… **ä¾¿äºæµ‹è¯•**ï¼šå¯ä»¥è½»æ¾ mock Context è¿›è¡Œå•å…ƒæµ‹è¯•

---

## 2. å‡çº§ç»„ä»¶ç³»ç»Ÿ

ä¸ºäº†é›†æˆ `Context`ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ `Component` åŸºç±»å’Œ `GameObject` è¿›è¡Œå‡çº§ã€‚

### component.hï¼ˆå‡çº§ç‰ˆï¼‰

```cpp
#pragma once

namespace engine::core {
    class Context;  // å‰å‘å£°æ˜
}

namespace engine::object {
    class GameObject;
}

namespace engine::component {

/**
 * @brief æ‰€æœ‰æ¸¸æˆç»„ä»¶çš„åŸºç±»ï¼ˆå‡çº§ç‰ˆï¼‰
 */
class Component {
public:
    Component() = default;
    virtual ~Component() = default;
    
    [[nodiscard]] engine::object::GameObject* getOwner() const { return owner_; }
    
protected:
    friend class engine::object::GameObject;
    
    virtual void init() {}
    virtual void handleInput(engine::core::Context& context) {}
    
    /**
     * @brief æ›´æ–°ç»„ä»¶çŠ¶æ€ï¼ˆçº¯è™šå‡½æ•°ï¼Œå¿…é¡»å®ç°ï¼‰
     * @param delta_time è·ä¸Šä¸€å¸§çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰
     * @param context å¼•æ“ä¸Šä¸‹æ–‡å¯¹è±¡
     */
    virtual void update(float delta_time, engine::core::Context& context) = 0;
    
    virtual void render(engine::core::Context& context) {}
    virtual void clean() {}
    
    engine::object::GameObject* owner_ = nullptr;
};

} // namespace engine::component
```

### å…³é”®æ”¹åŠ¨

| æ”¹åŠ¨ | è¯´æ˜ |
|------|------|
| **Context å‚æ•°** | å°† `Context` å¯¹è±¡ä½œä¸ºå‚æ•°æ·»åŠ åˆ° `handleInput`, `update`, `render` è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ |
| **çº¯è™šå‡½æ•°** | `update` å‡½æ•°å£°æ˜ä¸ºçº¯è™šå‡½æ•° `= 0`ã€‚è¿™æ„å‘³ç€ `Component` ç±»ç°åœ¨æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½è¢«ç›´æ¥å®ä¾‹åŒ– |
| **å¼ºåˆ¶å®ç°** | ä»»ä½•ç»§æ‰¿è‡ª `Component` çš„å­ç±»éƒ½å¿…é¡»å®ç°è‡ªå·±çš„ `update` æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªå¼ºåˆ¶æ€§çš„è®¾è®¡çº¦æŸï¼Œç¡®ä¿äº†æ‰€æœ‰ç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„æ›´æ–°é€»è¾‘ |

### game_object.h / .cppï¼ˆå‡çº§ç‰ˆï¼‰

ç›¸åº”åœ°ï¼Œ`GameObject` çš„ `handleInput`, `update`, `render` æ–¹æ³•ä¹Ÿè¦æ¥æ”¶ `Context` å‚æ•°ï¼Œå¹¶å°†å®ƒ **"é€ä¼ "** ç»™å…¶ç®¡ç†çš„æ‰€æœ‰ç»„ä»¶ã€‚

```cpp
// game_object.h
class GameObject final {
public:
    // ...
    void handleInput(engine::core::Context& context);
    void update(float delta_time, engine::core::Context& context);
    void render(engine::core::Context& context);
    // ...
};
```

```cpp
// game_object.cpp
void GameObject::handleInput(engine::core::Context& context) {
    for (auto& [type, component] : components_) {
        component->handleInput(context);
    }
}

void GameObject::update(float delta_time, engine::core::Context& context) {
    for (auto& [type, component] : components_) {
        component->update(delta_time, context);
    }
}

void GameObject::render(engine::core::Context& context) {
    for (auto& [type, component] : components_) {
        component->render(context);
    }
}
```

---

## 3. TransformComponentï¼šç©ºé—´å±æ€§çš„è½½ä½“

è¿™æ˜¯æˆ‘ä»¬ **ç¬¬ä¸€ä¸ªå…·ä½“çš„ç»„ä»¶**ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ä¸ªã€‚å®ƒå‡ ä¹æ˜¯ä¸€ä¸ªçº¯ç²¹çš„æ•°æ®å®¹å™¨ã€‚

### transform_component.h

```cpp
#pragma once
#include "./component.h"
#include <glm/vec2.hpp>

namespace engine::component {

/**
 * @class TransformComponent
 * @brief ç®¡ç† GameObject çš„ä½ç½®ã€æ—‹è½¬å’Œç¼©æ”¾ã€‚
 */
class TransformComponent final : public Component {
    friend class engine::object::GameObject;        // å‹å…ƒä¸èƒ½ç»§æ‰¿ï¼Œå¿…é¡»æ¯ä¸ªå­ç±»å•ç‹¬æ·»åŠ 
public:
    glm::vec2 position_ = {0.0f, 0.0f};     ///< @brief ä½ç½®
    glm::vec2 scale_ = {1.0f, 1.0f};        ///< @brief ç¼©æ”¾
    float rotation_ = 0.0f;                 ///< @brief è§’åº¦åˆ¶ï¼Œå•ä½ï¼šåº¦

    /**
     * @brief æ„é€ å‡½æ•°
     * @param position ä½ç½®
     * @param scale ç¼©æ”¾
     * @param rotation æ—‹è½¬
     */
    TransformComponent(glm::vec2 position = {0.0f, 0.0f}, glm::vec2 scale = {1.0f, 1.0f}, float rotation = 0.0f)
        : position_(position), scale_(scale), rotation_(rotation) {}

    // ç¦æ­¢æ‹·è´å’Œç§»åŠ¨
    TransformComponent(const TransformComponent&) = delete;
    TransformComponent& operator=(const TransformComponent&) = delete;
    TransformComponent(TransformComponent&&) = delete;
    TransformComponent& operator=(TransformComponent&&) = delete;

    // Getters and setters 
    const glm::vec2& getPosition() const { return position_; }              ///< @brief è·å–ä½ç½®
    float getRotation() const { return rotation_; }                         ///< @brief è·å–æ—‹è½¬
    const glm::vec2& getScale() const { return scale_; }                    ///< @brief è·å–ç¼©æ”¾
    void setPosition(const glm::vec2& position) { position_ = position; }   ///< @brief è®¾ç½®ä½ç½®
    void setRotation(float rotation) { rotation_ = rotation; }              ///< @brief è®¾ç½®æ—‹è½¬
    void setScale(const glm::vec2& scale);                                  ///< @brief è®¾ç½®ç¼©æ”¾ï¼Œåº”ç”¨ç¼©æ”¾æ—¶åº”åŒæ­¥æ›´æ–°Spriteåç§»é‡
    void translate(const glm::vec2& offset) { position_ += offset; }        ///< @brief å¹³ç§»

private:
    void update(float, engine::core::Context&) override {}                  ///< @brief è¦†ç›–çº¯è™šå‡½æ•°ï¼Œè¿™é‡Œä¸éœ€è¦å®ç°
};

} // namespace engine::component

```

### transform_component.cpp

```cpp
#include "transform_component.h"
#include "../object/game_object.h"
#include "sprite_component.h" 

namespace engine::component { 

void TransformComponent::setScale(const glm::vec2 &scale)
{
    scale_ = scale;
    if (owner_) {
        auto sprite_comp = owner_->getComponent<SpriteComponent>();
        if (sprite_comp) {
            sprite_comp->updateOffset();
        }
    }
}

} // namespace engine::component 
```

### è®¾è®¡ç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ•°æ®å®¹å™¨** | ä¸»è¦å­˜å‚¨ä¸‰ä¸ªåŸºæœ¬ç©ºé—´å±æ€§ï¼šä½ç½®ã€ç¼©æ”¾ã€æ—‹è½¬ |
| **ç©ºçš„ update** | å®ƒåªæœ‰ä¸€ä¸ªç©ºçš„ `update` æ–¹æ³•ï¼ˆä¸ºäº†æ»¡è¶³åŸºç±»çº¯è™šå‡½æ•°çš„è¦æ±‚ï¼‰ |
| **ç»„ä»¶åä½œ** | `setScale` å‡½æ•°å±•ç¤ºäº†ç»„ä»¶é—´åä½œçš„ç®€å•ä¾‹å­ï¼šå½“ç¼©æ”¾æ”¹å˜æ—¶ï¼Œå®ƒä¼šé€šçŸ¥ `SpriteComponent` æ›´æ–°å…¶åç§»é‡ |

> ğŸ’¡ **è®¾è®¡å“²å­¦**ï¼šTransformComponent æ˜¯ä¸€ä¸ªçº¯ç²¹çš„æ•°æ®ç»„ä»¶ï¼Œå®ƒä¸åŒ…å«å¤æ‚çš„é€»è¾‘ï¼Œåªè´Ÿè´£å­˜å‚¨å’Œæä¾›ç©ºé—´ä¿¡æ¯ã€‚

---

## 4. SpriteComponentï¼šèµ‹äºˆå¯¹è±¡è§†è§‰å½¢è±¡

è¿™æ˜¯æœ¬èŠ‚è¯¾çš„ **é‡å¤´æˆ**ï¼Œå®ƒè´Ÿè´£å°†ä¸€ä¸ª `Sprite` æ•°æ®å¯¹è±¡åœ¨å±å¹•ä¸Šç»˜åˆ¶å‡ºæ¥ã€‚

### ğŸ¨ å¯¹é½ï¼ˆAlignmentï¼‰æ¦‚å¿µ

åœ¨æ·±å…¥ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼š**å¯¹é½ï¼ˆAlignmentï¼‰ä¸åç§»ï¼ˆOffsetï¼‰**ã€‚

#### é—®é¢˜åœºæ™¯

`TransformComponent` çš„ `position` é€šå¸¸ä»£è¡¨ä¸€ä¸ª **é€»è¾‘ç‚¹**ï¼ˆæ¯”å¦‚è§’è‰²çš„è„šåº•ä¸­å¿ƒï¼‰ã€‚ä½†æˆ‘ä»¬ç»˜åˆ¶å›¾ç‰‡æ—¶ï¼Œéœ€è¦çš„æ˜¯ **å›¾ç‰‡å·¦ä¸Šè§’çš„åæ ‡**ã€‚

```
é€»è¾‘ä½ç½® (Transform.position)
    â†“
ä¸ä¸€å®šç­‰äº
    â†“
æ¸²æŸ“ä½ç½® (Sprite å·¦ä¸Šè§’)
```

#### è§£å†³æ–¹æ¡ˆ

**Alignment** å®šä¹‰äº†å›¾ç‰‡å‡ ä½•ä¸­å¿ƒä¸ `TransformComponent` çš„ `position` ç‚¹ä¹‹é—´çš„å…³ç³»ï¼š

```cpp
// engine/utils/alignment.h
namespace engine::utils {

/**
 * @enum class Alignment
 * @brief å®šä¹‰å¯¹è±¡æˆ–ç»„ä»¶ç›¸å¯¹äºå…¶ä½ç½®å‚è€ƒç‚¹çš„å¯¹é½æ–¹å¼ã€‚
 */
enum class Alignment {
    NONE,           // ä¸æŒ‡å®šå¯¹é½æ–¹å¼ï¼Œåç§»é‡é€šå¸¸ä¸º (0,0) æˆ–æ‰‹åŠ¨è®¾ç½®
    TOP_LEFT,       // å·¦ä¸Šè§’
    TOP_CENTER,     // é¡¶éƒ¨ä¸­å¿ƒ
    TOP_RIGHT,      // å³ä¸Šè§’
    CENTER_LEFT,    // ä¸­å¿ƒå·¦ä¾§
    CENTER,         // æ­£ä¸­å¿ƒ (å‡ ä½•ä¸­å¿ƒ)
    CENTER_RIGHT,   // ä¸­å¿ƒå³ä¾§
    BOTTOM_LEFT,    // å·¦ä¸‹è§’
    BOTTOM_CENTER,  // åº•éƒ¨ä¸­å¿ƒ
    BOTTOM_RIGHT    // å³ä¸‹è§’
};

} // namespace engine::utils
```

#### å¯è§†åŒ–è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TL   TC    TR   â”‚  TL = TOP_LEFT
â”‚                 â”‚  TC = TOP_CENTER
â”‚ CL   C     CR   â”‚  C  = CENTER
â”‚                 â”‚  BL = BOTTOM_LEFT
â”‚ BL   BC    BR   â”‚  ...
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

`SpriteComponent` ä¼šæ ¹æ®ï¼š
- å¯¹é½æ–¹å¼
- ç²¾çµå°ºå¯¸
- ç¼©æ”¾

è‡ªåŠ¨è®¡ç®—å‡ºä¸€ä¸ª `offset_`ï¼Œåœ¨æ¸²æŸ“æ—¶å°†è¿™ä¸ªåç§»é‡åº”ç”¨åˆ° `transform_->getPosition()` ä¸Šï¼Œä»è€Œå¾—åˆ°æ­£ç¡®çš„ç»˜åˆ¶åæ ‡ã€‚

### sprite_component.h

```cpp
#pragma once
#include "../render/sprite.h"
#include "./component.h"
#include "../utils/alignment.h"
#include <string>
#include <optional>
#include <SDL3/SDL_rect.h>
#include <glm/vec2.hpp>

namespace engine::core {
    class Context;
}

namespace engine::resource {
    class ResourceManager;
}

namespace engine::component {
class TransformComponent;

/**
 * @brief ç®¡ç† GameObject çš„è§†è§‰è¡¨ç¤ºï¼Œé€šè¿‡æŒæœ‰ä¸€ä¸ª Sprite å¯¹è±¡ã€‚
 *
 * åè°ƒ Sprite æ•°æ®å’Œæ¸²æŸ“é€»è¾‘ï¼Œå¹¶ä¸ TransformComponent äº¤äº’ã€‚
 */
class SpriteComponent final : public engine::component::Component {
    friend class engine::object::GameObject;            // å‹å…ƒä¸èƒ½ç»§æ‰¿ï¼Œå¿…é¡»æ¯ä¸ªå­ç±»å•ç‹¬æ·»åŠ 
private:
    engine::resource::ResourceManager* resource_manager_ = nullptr;         ///< @brief ä¿å­˜èµ„æºç®¡ç†å™¨æŒ‡é’ˆï¼Œç”¨äºè·å–çº¹ç†å¤§å°
    TransformComponent* transform_ = nullptr;                               ///< @brief ç¼“å­˜ TransformComponent æŒ‡é’ˆï¼ˆéå¿…é¡»ï¼‰

    engine::render::Sprite sprite_;                                         ///< @brief ç²¾çµå¯¹è±¡
    engine::utils::Alignment alignment_ = engine::utils::Alignment::NONE;   ///< @brief å¯¹é½æ–¹å¼
    glm::vec2 sprite_size_ = {0.0f, 0.0f};                                  ///< @brief ç²¾çµå°ºå¯¸
    glm::vec2 offset_ = {0.0f, 0.0f};                                       ///< @brief åç§»é‡
    bool is_hidden_ = false;                                                ///< @brief æ˜¯å¦éšè—ï¼ˆä¸æ¸²æŸ“ï¼‰
    
public:
    /**
     * @brief æ„é€ å‡½æ•°
     * @param texture_id çº¹ç†èµ„æºçš„æ ‡è¯†ç¬¦ã€‚
     * @param resource_manager èµ„æºç®¡ç†å™¨æŒ‡é’ˆã€‚
     * @param alignment åˆå§‹å¯¹é½æ–¹å¼ã€‚
     * @param source_rect_opt å¯é€‰çš„æºçŸ©å½¢ã€‚
     * @param is_flipped åˆå§‹ç¿»è½¬çŠ¶æ€ã€‚
     */
    SpriteComponent(
        const std::string& texture_id,
        engine::resource::ResourceManager& resource_manager,
        engine::utils::Alignment alignment = engine::utils::Alignment::NONE,
        std::optional<SDL_FRect> source_rect_opt = std::nullopt,
        bool is_flipped = false
    );
    ~SpriteComponent() override = default;

    // ç¦æ­¢æ‹·è´å’Œç§»åŠ¨
    SpriteComponent(const SpriteComponent&) = delete;
    SpriteComponent& operator=(const SpriteComponent&) = delete;
    SpriteComponent(SpriteComponent&&) = delete;
    SpriteComponent& operator=(SpriteComponent&&) = delete;

    void updateOffset();           ///< @brief æ›´æ–°åç§»é‡(æ ¹æ®å½“å‰çš„ alignment_ å’Œ sprite_size_ è®¡ç®— offset_)ã€‚

    // Getters
    const engine::render::Sprite& getSprite() const { return sprite_; }         ///< @brief è·å–ç²¾çµå¯¹è±¡
    const std::string& getTextureId() const { return sprite_.getTextureId(); }  ///< @brief è·å–çº¹ç†ID
    bool isFlipped() const { return sprite_.isFlipped(); }                      ///< @brief è·å–æ˜¯å¦ç¿»è½¬
    bool isHidden() const { return is_hidden_; }                                ///< @brief è·å–æ˜¯å¦éšè—
    const glm::vec2& getSpriteSize() const { return sprite_size_; }             ///< @brief è·å–ç²¾çµå°ºå¯¸
    const glm::vec2& getOffset() const { return offset_; }                      ///< @brief è·å–åç§»é‡
    engine::utils::Alignment getAlignment() const { return alignment_; }        ///< @brief è·å–å¯¹é½æ–¹å¼

    // Setters
    void setSpriteById(const std::string& texture_id, const std::optional<SDL_FRect>& source_rect_opt = std::nullopt); ///< @brief è®¾ç½®ç²¾çµå¯¹è±¡
    void setFlipped(bool flipped) { sprite_.setFlipped(flipped); }                                             ///< @brief è®¾ç½®æ˜¯å¦ç¿»è½¬
    void setHidden(bool hidden) { is_hidden_ = hidden; }                                                      ///< @brief è®¾ç½®æ˜¯å¦éšè—
    void setSourceRect(const std::optional<SDL_FRect>& source_rect_opt);                                     ///< @brief è®¾ç½®æºçŸ©å½¢
    void setAlignment(engine::utils::Alignment anchor);                                                     ///< @brief è®¾ç½®å¯¹é½æ–¹å¼

private:
    void updateSpriteSize();        ///< @brief è¾…åŠ©å‡½æ•°ï¼Œæ ¹æ® sprite_ çš„ source_rect_ æ›´æ–° sprite_size_

    // Component è™šå‡½æ•°è¦†ç›–
    void init() override;                                                   ///< @brief åˆå§‹åŒ–å‡½æ•°éœ€è¦è¦†ç›–
    void update(float, engine::core::Context&) override {}                  ///< @brief æ›´æ–°å‡½æ•°ç•™ç©º
    void render(engine::core::Context& context) override;                   ///< @brief æ¸²æŸ“å‡½æ•°éœ€è¦è¦†ç›–

};

} // namespace engine::component
```

### sprite_component.cpp

```cpp
#include "sprite_component.h"
#include "transform_component.h"
#include "../object/game_object.h"
#include "../core/context.h"
#include "../render/renderer.h"
#include "../resource/resource_manager.h"
#include "../render/camera.h"
#include <stdexcept>          // ç”¨äº std::runtime_error
#include <spdlog/spdlog.h>

namespace engine::component {

SpriteComponent::SpriteComponent(
    const std::string& texture_id,
    engine::resource::ResourceManager& resource_manager,
    engine::utils::Alignment alignment,
    std::optional<SDL_FRect> source_rect_opt,
    bool is_flipped
) : resource_manager_(&resource_manager), sprite_(texture_id, source_rect_opt, is_flipped),
    alignment_(alignment)
{  
    if (!resource_manager_) {
        spdlog::critical("åˆ›å»º SpriteComponent æ—¶ ResourceManager ä¸ºç©ºï¼ï¼Œæ­¤ç»„ä»¶å°†æ— æ•ˆã€‚");
        // ä¸è¦åœ¨æ¸¸æˆä¸»å¾ªç¯ä¸­ä½¿ç”¨ try...catch / throwï¼Œä¼šæå¤§å½±å“æ€§èƒ½
    }
    // offset_ å’Œ sprite_size_ å°†åœ¨ init ä¸­è®¡ç®—
    spdlog::trace("åˆ›å»º SpriteComponentï¼Œçº¹ç†ID: {}", texture_id);
}

void SpriteComponent::init() {
    if (!owner_) {
        spdlog::error("SpriteComponent åœ¨åˆå§‹åŒ–å‰æœªè®¾ç½®æ‰€æœ‰è€…ã€‚");
        return;
    }
    transform_ = owner_->getComponent<TransformComponent>();
    if (!transform_) {
        spdlog::warn(
            "GameObject '{}' ä¸Šçš„ SpriteComponent éœ€è¦ä¸€ä¸ª TransformComponentï¼Œä½†æœªæ‰¾åˆ°ã€‚",
            owner_->getName()
        );
        // Spriteæ²¡æœ‰Transformæ— æ³•è®¡ç®—åç§»å’Œæ¸²æŸ“ï¼Œç›´æ¥è¿”å›
        return;
    }

    // è·å–å¤§å°åŠåç§»
    updateSpriteSize();
    updateOffset();
}

void SpriteComponent::setAlignment(engine::utils::Alignment anchor) {
    alignment_ = anchor;
    updateOffset();
}

void SpriteComponent::updateOffset() {
    // å¦‚æœå°ºå¯¸æ— æ•ˆï¼Œåç§»ä¸º0
    if (sprite_size_.x <= 0 || sprite_size_.y <= 0) {
        offset_ = {0.0f, 0.0f};
        return;
    }
    auto scale = transform_->getScale();
    // è®¡ç®—ç²¾çµå·¦ä¸Šè§’ç›¸å¯¹äº TransformComponent::position_ çš„åç§»
    switch (alignment_) {
        case engine::utils::Alignment::TOP_LEFT:      offset_ = glm::vec2{0.0f, 0.0f} * scale; break;
        case engine::utils::Alignment::TOP_CENTER:    offset_ = glm::vec2{-sprite_size_.x / 2.0f, 0.0f} * scale; break;
        case engine::utils::Alignment::TOP_RIGHT:     offset_ = glm::vec2{-sprite_size_.x, 0.0f} * scale; break;
        case engine::utils::Alignment::CENTER_LEFT:   offset_ = glm::vec2{0.0f, -sprite_size_.y / 2.0f} * scale; break;
        case engine::utils::Alignment::CENTER:        offset_ = glm::vec2{-sprite_size_.x / 2.0f, -sprite_size_.y / 2.0f} * scale; break;
        case engine::utils::Alignment::CENTER_RIGHT:  offset_ = glm::vec2{-sprite_size_.x, -sprite_size_.y / 2.0f} * scale; break;
        case engine::utils::Alignment::BOTTOM_LEFT:   offset_ = glm::vec2{0.0f, -sprite_size_.y} * scale; break;
        case engine::utils::Alignment::BOTTOM_CENTER: offset_ = glm::vec2{-sprite_size_.x / 2.0f, -sprite_size_.y} * scale; break;
        case engine::utils::Alignment::BOTTOM_RIGHT:  offset_ = glm::vec2{-sprite_size_.x, -sprite_size_.y} * scale; break;
        case engine::utils::Alignment::NONE:
        default:                                      break;
    }
}

void SpriteComponent::render(engine::core::Context& context) {
    if (is_hidden_ || !transform_ || !resource_manager_) {
        return;
    }

    // è·å–å˜æ¢ä¿¡æ¯ï¼ˆè€ƒè™‘åç§»é‡ï¼‰
    const glm::vec2& pos = transform_->getPosition() + offset_;
    const glm::vec2& scale = transform_->getScale();
    float rotation_degrees = transform_->getRotation();

    // æ‰§è¡Œç»˜åˆ¶
    context.getRenderer().drawSprite(context.getCamera(), sprite_, pos, scale, rotation_degrees);
}

void SpriteComponent::setSpriteById(const std::string& texture_id, const std::optional<SDL_FRect>& source_rect_opt) {
    sprite_.setTextureId(texture_id);
    sprite_.setSourceRect(source_rect_opt);

    updateSpriteSize();
    updateOffset();
}

void SpriteComponent::setSourceRect(const std::optional<SDL_FRect>& source_rect_opt) {
    sprite_.setSourceRect(source_rect_opt);
    updateSpriteSize();
    updateOffset();
}

void SpriteComponent::updateSpriteSize() {
    if (!resource_manager_) {
        spdlog::error("ResourceManager ä¸ºç©ºï¼æ— æ³•è·å–çº¹ç†å°ºå¯¸ã€‚");
        return;
    }
    if (sprite_.getSourceRect().has_value()) {
        const auto& src_rect = sprite_.getSourceRect().value();
        sprite_size_ = {src_rect.w, src_rect.h};
    } else {
        sprite_size_ = resource_manager_->getTextureSize(sprite_.getTextureId());
    }
}

} // namespace engine::component 
```

### æ ¸å¿ƒæ–¹æ³•è§£æ

| æ–¹æ³• | èŒè´£ |
|------|------|
| `init()` | ä» `owner_`ï¼ˆå³æ‰€å±çš„ GameObjectï¼‰è·å– `TransformComponent` çš„æŒ‡é’ˆï¼Œå¹¶è®¡ç®—åˆå§‹çš„ç²¾çµå°ºå¯¸å’Œåç§»é‡ |
| `render(Context&)` | **æ ¸å¿ƒèŒè´£**ã€‚ä» `transform_` è·å–æœ€æ–°çš„ä½ç½®ã€ç¼©æ”¾å’Œæ—‹è½¬ï¼ŒåŠ ä¸Šè®¡ç®—å¥½çš„åç§»é‡ï¼Œç„¶åé€šè¿‡ context è·å– Renderer å’Œ Cameraï¼Œæœ€åè°ƒç”¨ `renderer.drawSprite()` å®Œæˆç»˜åˆ¶ |
| `updateOffset()` | æ ¹æ®å¯¹é½æ–¹å¼ã€ç²¾çµå°ºå¯¸å’Œç¼©æ”¾ï¼Œè®¡ç®—æ­£ç¡®çš„æ¸²æŸ“åç§»é‡ |

---

## 5. é›†æˆä¸æµ‹è¯•

æœ€åï¼Œæˆ‘ä»¬åœ¨ `GameApp` ä¸­å°†æ‰€æœ‰æ–°æ¨¡å—æ•´åˆèµ·æ¥ã€‚

### åˆå§‹åŒ– Context

```cpp
// game_app.h
class GameApp final {
private:
    std::unique_ptr<engine::core::Context> context_;
    
    [[nodiscard]] bool initContext();
    // ...
};
```

```cpp
// game_app.cpp
// åˆ›å»ºä¸€ä¸ªæµ‹è¯•game_object
engine::object::GameObject game_object("test_game_object");

bool GameApp::initContext() {
    try {
        context_ = std::make_unique<engine::core::Context>(
            *input_manager_,
            *renderer_,
            *camera_,
            *resource_manager_
        );
    } catch (const std::exception& e) {
        spdlog::error("åˆå§‹åŒ–ä¸Šä¸‹æ–‡å¤±è´¥: {}", e.what());
        return false;
    }
    spdlog::trace("ä¸Šä¸‹æ–‡åˆå§‹åŒ–æˆåŠŸã€‚");
    return true;
}

bool GameApp::init() {
    // ...
    if (!initConfig()) return false;
    if (!initSDL()) return false;
    if (!initResourceManager()) return false;
    if (!initRenderer()) return false;
    if (!initCamera()) return false;
    if (!initInputManager()) return false;
    if (!initTime()) return false;
    if (!initContext()) return false;  // åœ¨æ‰€æœ‰ç®¡ç†å™¨åˆå§‹åŒ–å®Œæ¯•ååˆ›å»º
    // ...
}
```

### æ›´æ–°ä¸»å¾ªç¯

```cpp

void GameApp::render() {
    // 1. æ¸…é™¤å±å¹•
    renderer_->clearScreen();

    // 2. å…·ä½“æ¸²æŸ“ä»£ç 
    testRenderer();
    game_object.render(*context_);  // æ¸²æŸ“æ—¶æ›´æ–°

    // 3. æ›´æ–°å±å¹•æ˜¾ç¤º
    renderer_->present();
}
```

### å®Œæ•´æµ‹è¯•

```cpp
void GameApp::testGameObject() {
    spdlog::info("========== æµ‹è¯•ç»„ä»¶ç³»ç»Ÿ ==========");
    
    // 1. æ·»åŠ  TransformComponentï¼Œè®©å¯¹è±¡å‡ºç°åœ¨ (100, 100)
    game_object.addComponent<engine::component::TransformComponent>(
        glm::vec2(100.0f, 100.0f)
    );
    
    // 2. æ·»åŠ  SpriteComponentï¼Œæ˜¾ç¤ºç®±å­è´´å›¾ï¼Œè®¾ç½®æ¸²æŸ“ä¸­å¿ƒä¸ºå›¾ç‰‡çš„å‡ ä½•ä¸­å¿ƒ
    game_object.addComponent<engine::component::SpriteComponent>(
        "assets/textures/Props/big-crate.png",
        *resource_manager_,
        engine::utils::Alignment::CENTER
    );
    
    // 3. è·å– TransformComponentï¼Œä¿®æ”¹ç¼©æ”¾å’Œæ—‹è½¬
    game_object.getComponent<engine::component::TransformComponent>()->setScale(glm::vec2(2.0f, 2.0f));  // æ”¾å¤§ 2 å€
    game_object.getComponent<engine::component::TransformComponent>()->setRotation(30.0f);                // æ—‹è½¬ 30 åº¦
        spdlog::info("âœ“ Transform ç»„ä»¶é…ç½®å®Œæˆ");
    }
    
    spdlog::info("====================================");
}
```

### âœ… ç¼–è¯‘ä¸è¿è¡Œ

ç¼–è¯‘å¹¶è¿è¡Œä½ çš„é¡¹ç›®ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ å°†åœ¨å±å¹•ä¸Šçœ‹åˆ°ï¼š

```
ğŸ® è¿è¡Œæ•ˆæœï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚
â”‚     â•±â”€â”€â”€â”€â•²              â”‚
â”‚    â•±  ğŸ“¦  â•²   â† è¢«æ”¾å¤§  â”‚
â”‚    â•²      â•±     å€¾æ–œ30Â° â”‚
â”‚     â•²â”€â”€â”€â”€â•±              â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ§ª å®éªŒå»ºè®®

ä½ å¯ä»¥å°è¯•ä¿®æ”¹ `testGameObject` ä¸­çš„å‚æ•°ï¼Œçœ‹çœ‹å®ƒå¦‚ä½•å½±å“å±å¹•ä¸Šçš„ç‰©ä½“ï¼š

```cpp
// å®éªŒ 1ï¼šæ”¹å˜ä½ç½®
transform->setPosition(glm::vec2(320.0f, 180.0f));  // ç§»åˆ°å±å¹•ä¸­å¿ƒ

// å®éªŒ 2ï¼šæ”¹å˜ç¼©æ”¾
transform->setScale(glm::vec2(3.0f, 1.0f));  // æ°´å¹³æ‹‰ä¼¸

// å®éªŒ 3ï¼šæ”¹å˜æ—‹è½¬
transform->setRotation(45.0f);  // å€¾æ–œ 45 åº¦

// å®éªŒ 4ï¼šæ”¹å˜å¯¹é½æ–¹å¼
sprite->setAlignment(engine::utils::Alignment::BOTTOM_CENTER);  // è„šåº•å¯¹é½
```

---

## ğŸ¯ ç³»ç»Ÿæ¶æ„æ€»ç»“

### æ ¸å¿ƒæˆå°±

æˆ‘ä»¬æˆåŠŸåœ°ï¼š

1. âœ… **å¼•å…¥ä¾èµ–æ³¨å…¥**ï¼šé€šè¿‡ Context ç±»ä¼˜é›…åœ°è§£å†³äº†ç»„ä»¶ä¸å¼•æ“æ¨¡å—çš„é€šä¿¡é—®é¢˜
2. âœ… **å®ç°å…·ä½“ç»„ä»¶**ï¼šåˆ›å»ºäº† TransformComponent å’Œ SpriteComponent ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶
3. âœ… **æ•°æ®è¡Œä¸ºåˆ†ç¦»**ï¼šå°†æ•°æ®ï¼ˆTransformComponentï¼‰å’Œè¡Œä¸ºï¼ˆSpriteComponentï¼‰åˆ†ç¦»
4. âœ… **ç»„ä»¶åä½œ**ï¼šå±•ç¤ºäº†ç»„ä»¶é—´å¦‚ä½•ç›¸äº’é…åˆï¼ˆTransform é€šçŸ¥ Sprite æ›´æ–°ï¼‰

### è®¾è®¡äº®ç‚¹

| ç‰¹æ€§ | å®ç°æ–¹å¼ | ä¼˜åŠ¿ |
|------|----------|------|
| **ä¾èµ–æ³¨å…¥** | Context ç±»ç»Ÿä¸€ç®¡ç†å¼•æ“æ¨¡å—å¼•ç”¨ | æ¾è€¦åˆã€æ˜“æµ‹è¯•ã€å¯æ‰©å±• |
| **å¯¹é½ç³»ç»Ÿ** | Alignment æšä¸¾ + è‡ªåŠ¨åç§»è®¡ç®— | çµæ´»çš„ç²¾çµå®šä½ |
| **çº¯è™šå‡½æ•°** | Component::update() å£°æ˜ä¸ºçº¯è™š | å¼ºåˆ¶æ‰€æœ‰ç»„ä»¶å®ç°æ›´æ–°é€»è¾‘ |
| **ç»„ä»¶ç¼“å­˜** | SpriteComponent ç¼“å­˜ Transform æŒ‡é’ˆ | é¿å…é‡å¤æŸ¥æ‰¾ï¼Œæé«˜æ€§èƒ½ |

### å·¥ä½œæµç¨‹

```
GameObject
    â”œâ”€â”€ TransformComponent (æ•°æ®å±‚)
    â”‚   â”œâ”€â”€ ä½ç½®: (100, 100)
    â”‚   â”œâ”€â”€ ç¼©æ”¾: (2.0, 2.0)
    â”‚   â””â”€â”€ æ—‹è½¬: 30Â°
    â”‚
    â””â”€â”€ SpriteComponent (è¡¨ç°å±‚)
        â”œâ”€â”€ è¯»å– Transform æ•°æ®
        â”œâ”€â”€ è®¡ç®—åç§»é‡ï¼ˆåŸºäºå¯¹é½ï¼‰
        â”œâ”€â”€ é€šè¿‡ Context è·å– Renderer
        â””â”€â”€ è°ƒç”¨ drawSprite() æ¸²æŸ“
```

---

## ğŸ’¡ è®¾è®¡æ¨¡å¼å›é¡¾

### 1. ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰

GameObject ç»„åˆå¤šä¸ª Componentï¼Œè€Œéç»§æ‰¿å®ç°åŠŸèƒ½ã€‚

### 2. ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰

é€šè¿‡ Context æ³¨å…¥ä¾èµ–ï¼Œè€Œéç¡¬ç¼–ç å¼•ç”¨ã€‚

### 3. è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆç®€åŒ–ç‰ˆï¼‰

TransformComponent çš„ `setScale()` é€šçŸ¥ SpriteComponent æ›´æ–°ã€‚

---

## ğŸš€ ä¸‹ä¸€æ­¥

ç°åœ¨æˆ‘ä»¬æœ‰äº†ï¼š
- ğŸ¯ ä½ç½®ç³»ç»Ÿï¼ˆTransformComponentï¼‰
- ğŸ¨ æ¸²æŸ“ç³»ç»Ÿï¼ˆSpriteComponentï¼‰
- ğŸ”§ ä¾èµ–ç®¡ç†ï¼ˆContextï¼‰

æœªæ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šç»„ä»¶ï¼š
- ç‰©ç†ç»„ä»¶ï¼ˆPhysicsComponentï¼‰
- éŸ³é¢‘ç»„ä»¶ï¼ˆAudioComponentï¼‰
- åŠ¨ç”»ç»„ä»¶ï¼ˆAnimationComponentï¼‰

é€šè¿‡ GameObject å’Œè¿™äº›ç»„ä»¶çš„ç»„åˆï¼Œæˆ‘ä»¬å°†"ç»„è£…"å‡ºå®Œæ•´çš„æ¸¸æˆä¸–ç•Œï¼

---

## ğŸ“š æ€»ç»“

æˆ‘ä»¬æˆåŠŸåœ°å°†æ•°æ®ï¼ˆTransformComponentï¼‰å’Œè¡Œä¸ºï¼ˆSpriteComponentï¼‰åˆ†ç¦»ï¼Œå¹¶é€šè¿‡ GameObject å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œåˆ›å»ºå‡ºäº†ä¸€ä¸ª **å¯è§ã€å¯æ“ä½œçš„æ¸¸æˆå®ä½“**ã€‚

**å…³é”®è¦ç‚¹ï¼š**
- ğŸ—ï¸ Context ç±»ä¼˜é›…åœ°è§£å†³äº†ä¾èµ–ç®¡ç†é—®é¢˜
- ğŸ“ TransformComponent æä¾›ç©ºé—´å±æ€§
- ğŸ¨ SpriteComponent å®ç°è§†è§‰æ¸²æŸ“
- ğŸ”— ç»„ä»¶é—´é€šè¿‡ owner_ å®ç°åä½œ
- âš™ï¸ Alignment ç³»ç»Ÿæä¾›çµæ´»çš„ç²¾çµå®šä½

è¿™æ˜¯æˆ‘ä»¬æ¨¡å—åŒ–æ¸¸æˆå¼•æ“è¿ˆå‡ºçš„ **åšå®ä¸€æ­¥**ï¼ğŸ‰
